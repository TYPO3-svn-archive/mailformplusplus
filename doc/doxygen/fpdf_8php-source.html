<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>mailformplusplus: fpdf.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>fpdf.php</h1><a href="fpdf_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/*******************************************************************************</span>
<a name="l00003"></a>00003 <span class="comment">* FPDF                                                                         *</span>
<a name="l00004"></a>00004 <span class="comment">*                                                                              *</span>
<a name="l00005"></a>00005 <span class="comment">* Version: 1.6                                                                 *</span>
<a name="l00006"></a>00006 <span class="comment">* Date:    2008-08-03                                                          *</span>
<a name="l00007"></a>00007 <span class="comment">* Author:  Olivier PLATHEY                                                     *</span>
<a name="l00008"></a>00008 <span class="comment">*******************************************************************************/</span>
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="fpdf_8php.html#84b38adcfb3c697594472e91adf42b2e">00010</a> define(<span class="stringliteral">'FPDF_VERSION'</span>,<span class="stringliteral">'1.6'</span>);
<a name="l00011"></a>00011 
<a name="l00023"></a><a class="code" href="class_f_p_d_f.html">00023</a> <span class="keyword">class </span><a class="code" href="class_f_p_d_f.html">FPDF</a>
<a name="l00024"></a>00024 {
<a name="l00025"></a><a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">00025</a> var <a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">$page</a>;               <span class="comment">//current page number</span>
<a name="l00026"></a><a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">00026</a> var <a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>;                  <span class="comment">//current object number</span>
<a name="l00027"></a><a class="code" href="class_f_p_d_f.html#15347dda89239d5fa79ead40a72e0e34">00027</a> var <a class="code" href="class_f_p_d_f.html#15347dda89239d5fa79ead40a72e0e34">$offsets</a>;            <span class="comment">//array of object offsets</span>
<a name="l00028"></a><a class="code" href="class_f_p_d_f.html#a5e639d922350949dc1a58a4597c58bb">00028</a> var <a class="code" href="class_f_p_d_f.html#a5e639d922350949dc1a58a4597c58bb">$buffer</a>;             <span class="comment">//buffer holding in-memory PDF</span>
<a name="l00029"></a><a class="code" href="class_f_p_d_f.html#43708e8b1a7d9c88f08982c4473d7767">00029</a> var <a class="code" href="class_f_p_d_f.html#43708e8b1a7d9c88f08982c4473d7767">$pages</a>;              <span class="comment">//array containing pages</span>
<a name="l00030"></a><a class="code" href="class_f_p_d_f.html#8aef065fb2791fd919608521a801b7d3">00030</a> var <a class="code" href="class_f_p_d_f.html#8aef065fb2791fd919608521a801b7d3">$state</a>;              <span class="comment">//current document state</span>
<a name="l00031"></a><a class="code" href="class_f_p_d_f.html#6effca6f281458983c61647878f6dc18">00031</a> var <a class="code" href="class_f_p_d_f.html#6effca6f281458983c61647878f6dc18">$compress</a>;           <span class="comment">//compression flag</span>
<a name="l00032"></a><a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">00032</a> var <a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>;                  <span class="comment">//scale factor (number of points in user unit)</span>
<a name="l00033"></a><a class="code" href="class_f_p_d_f.html#d1640384fda9ee53cf7295eb823a31dc">00033</a> var <a class="code" href="class_f_p_d_f.html#d1640384fda9ee53cf7295eb823a31dc">$DefOrientation</a>;     <span class="comment">//default orientation</span>
<a name="l00034"></a><a class="code" href="class_f_p_d_f.html#40250e931a9dd32601bbe2a5a1eaf492">00034</a> var <a class="code" href="class_f_p_d_f.html#40250e931a9dd32601bbe2a5a1eaf492">$CurOrientation</a>;     <span class="comment">//current orientation</span>
<a name="l00035"></a><a class="code" href="class_f_p_d_f.html#325913b88d69e8892a9b6235af96320a">00035</a> var <a class="code" href="class_f_p_d_f.html#325913b88d69e8892a9b6235af96320a">$PageFormats</a>;        <span class="comment">//available page formats</span>
<a name="l00036"></a><a class="code" href="class_f_p_d_f.html#d72f7030122acac24af9de836f570130">00036</a> var <a class="code" href="class_f_p_d_f.html#d72f7030122acac24af9de836f570130">$DefPageFormat</a>;      <span class="comment">//default page format</span>
<a name="l00037"></a><a class="code" href="class_f_p_d_f.html#d070be707b23a80f8f1eae4504caaf8a">00037</a> var <a class="code" href="class_f_p_d_f.html#d070be707b23a80f8f1eae4504caaf8a">$CurPageFormat</a>;      <span class="comment">//current page format</span>
<a name="l00038"></a><a class="code" href="class_f_p_d_f.html#d5c52368f21457ca93d7f557a1cf5705">00038</a> var <a class="code" href="class_f_p_d_f.html#d5c52368f21457ca93d7f557a1cf5705">$PageSizes</a>;          <span class="comment">//array storing non-default page sizes</span>
<a name="l00039"></a><a class="code" href="class_f_p_d_f.html#7b22f93934a55c4d60d730ae69d94b6c">00039</a> var <a class="code" href="class_f_p_d_f.html#7b22f93934a55c4d60d730ae69d94b6c">$wPt</a>,<a class="code" href="class_f_p_d_f.html#c49ef47de69b357309f22c19231863e8">$hPt</a>;           <span class="comment">//dimensions of current page in points</span>
<a name="l00040"></a><a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">00040</a> var <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;               <span class="comment">//dimensions of current page in user unit</span>
<a name="l00041"></a><a class="code" href="class_f_p_d_f.html#52016e769b24e87eae66b3f3a7e9eb97">00041</a> var <a class="code" href="class_f_p_d_f.html#52016e769b24e87eae66b3f3a7e9eb97">$lMargin</a>;            <span class="comment">//left margin</span>
<a name="l00042"></a><a class="code" href="class_f_p_d_f.html#89d24fb15623f31293ef11860ec53a77">00042</a> var <a class="code" href="class_f_p_d_f.html#89d24fb15623f31293ef11860ec53a77">$tMargin</a>;            <span class="comment">//top margin</span>
<a name="l00043"></a><a class="code" href="class_f_p_d_f.html#380553db1fe34ac31eab846ec98a366a">00043</a> var <a class="code" href="class_f_p_d_f.html#380553db1fe34ac31eab846ec98a366a">$rMargin</a>;            <span class="comment">//right margin</span>
<a name="l00044"></a><a class="code" href="class_f_p_d_f.html#45f713138b48185ffb8d6952158275b6">00044</a> var <a class="code" href="class_f_p_d_f.html#45f713138b48185ffb8d6952158275b6">$bMargin</a>;            <span class="comment">//page break margin</span>
<a name="l00045"></a><a class="code" href="class_f_p_d_f.html#f17b206c29beaba34856e916a2baf227">00045</a> var <a class="code" href="class_f_p_d_f.html#f17b206c29beaba34856e916a2baf227">$cMargin</a>;            <span class="comment">//cell margin</span>
<a name="l00046"></a><a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">00046</a> var <a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>,<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>;               <span class="comment">//current position in user unit</span>
<a name="l00047"></a><a class="code" href="class_f_p_d_f.html#95a0a41b723b698af4b1e4a08e443388">00047</a> var <a class="code" href="class_f_p_d_f.html#95a0a41b723b698af4b1e4a08e443388">$lasth</a>;              <span class="comment">//height of last printed cell</span>
<a name="l00048"></a><a class="code" href="class_f_p_d_f.html#563f4dec18a06abc382f2e31fe456fe8">00048</a> var <a class="code" href="class_f_p_d_f.html#563f4dec18a06abc382f2e31fe456fe8">$LineWidth</a>;          <span class="comment">//line width in user unit</span>
<a name="l00049"></a><a class="code" href="class_f_p_d_f.html#59722e9eb7f9a67dbe330d93723204a6">00049</a> var <a class="code" href="class_f_p_d_f.html#59722e9eb7f9a67dbe330d93723204a6">$CoreFonts</a>;          <span class="comment">//array of standard font names</span>
<a name="l00050"></a><a class="code" href="class_f_p_d_f.html#d9fe36831d63d0ef57539a0cccef2b49">00050</a> var <a class="code" href="class_f_p_d_f.html#d9fe36831d63d0ef57539a0cccef2b49">$fonts</a>;              <span class="comment">//array of used fonts</span>
<a name="l00051"></a><a class="code" href="class_f_p_d_f.html#84252c77b8f99df59e282bb23e7c9194">00051</a> var <a class="code" href="class_f_p_d_f.html#84252c77b8f99df59e282bb23e7c9194">$FontFiles</a>;          <span class="comment">//array of font files</span>
<a name="l00052"></a><a class="code" href="class_f_p_d_f.html#b4031513b29691bb8fb7107c73cc2d64">00052</a> var <a class="code" href="class_f_p_d_f.html#b4031513b29691bb8fb7107c73cc2d64">$diffs</a>;              <span class="comment">//array of encoding differences</span>
<a name="l00053"></a><a class="code" href="class_f_p_d_f.html#5f8c02cd5e40614758f3ffc421e06b78">00053</a> var <a class="code" href="class_f_p_d_f.html#5f8c02cd5e40614758f3ffc421e06b78">$FontFamily</a>;         <span class="comment">//current font family</span>
<a name="l00054"></a><a class="code" href="class_f_p_d_f.html#20531c00b4f38558ee888a16e16ef768">00054</a> var <a class="code" href="class_f_p_d_f.html#20531c00b4f38558ee888a16e16ef768">$FontStyle</a>;          <span class="comment">//current font style</span>
<a name="l00055"></a><a class="code" href="class_f_p_d_f.html#2d65d65ac5a4d1f173a2d61bfc7ca621">00055</a> var <a class="code" href="class_f_p_d_f.html#2d65d65ac5a4d1f173a2d61bfc7ca621">$underline</a>;          <span class="comment">//underlining flag</span>
<a name="l00056"></a><a class="code" href="class_f_p_d_f.html#48fd94c929ceac390039ac4928fd8110">00056</a> var <a class="code" href="class_f_p_d_f.html#48fd94c929ceac390039ac4928fd8110">$CurrentFont</a>;        <span class="comment">//current font info</span>
<a name="l00057"></a><a class="code" href="class_f_p_d_f.html#d7b6864ec7f83300c00ae1a1c9123c0b">00057</a> var <a class="code" href="class_f_p_d_f.html#d7b6864ec7f83300c00ae1a1c9123c0b">$FontSizePt</a>;         <span class="comment">//current font size in points</span>
<a name="l00058"></a><a class="code" href="class_f_p_d_f.html#b99639f298b8daefa72e6fbc487eeae6">00058</a> var <a class="code" href="class_f_p_d_f.html#b99639f298b8daefa72e6fbc487eeae6">$FontSize</a>;           <span class="comment">//current font size in user unit</span>
<a name="l00059"></a><a class="code" href="class_f_p_d_f.html#80a2ec9b8a4e1104bc093c0856766db3">00059</a> var <a class="code" href="class_f_p_d_f.html#80a2ec9b8a4e1104bc093c0856766db3">$DrawColor</a>;          <span class="comment">//commands for drawing color</span>
<a name="l00060"></a><a class="code" href="class_f_p_d_f.html#75f15d0e648b984c9209c32388912aeb">00060</a> var <a class="code" href="class_f_p_d_f.html#75f15d0e648b984c9209c32388912aeb">$FillColor</a>;          <span class="comment">//commands for filling color</span>
<a name="l00061"></a><a class="code" href="class_f_p_d_f.html#258b7f98af80620e2d2425f75c1734ac">00061</a> var <a class="code" href="class_f_p_d_f.html#258b7f98af80620e2d2425f75c1734ac">$TextColor</a>;          <span class="comment">//commands for text color</span>
<a name="l00062"></a><a class="code" href="class_f_p_d_f.html#e9a2ff1c3ff43210435b4276e579498a">00062</a> var <a class="code" href="class_f_p_d_f.html#e9a2ff1c3ff43210435b4276e579498a">$ColorFlag</a>;          <span class="comment">//indicates whether fill and text colors are different</span>
<a name="l00063"></a><a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">00063</a> var <a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>;                 <span class="comment">//word spacing</span>
<a name="l00064"></a><a class="code" href="class_f_p_d_f.html#fc8b2e219390a60499ed3d6a28b31f2d">00064</a> var <a class="code" href="class_f_p_d_f.html#fc8b2e219390a60499ed3d6a28b31f2d">$images</a>;             <span class="comment">//array of used images</span>
<a name="l00065"></a><a class="code" href="class_f_p_d_f.html#3e93616a74e983712775cb72a00fed38">00065</a> var <a class="code" href="class_f_p_d_f.html#3e93616a74e983712775cb72a00fed38">$PageLinks</a>;          <span class="comment">//array of links in pages</span>
<a name="l00066"></a><a class="code" href="class_f_p_d_f.html#d75c5e32c5417504ba4d351e0383869f">00066</a> var <a class="code" href="class_f_p_d_f.html#d75c5e32c5417504ba4d351e0383869f">$links</a>;              <span class="comment">//array of internal links</span>
<a name="l00067"></a><a class="code" href="class_f_p_d_f.html#d196be21405b44433e08efedf63fcf27">00067</a> var <a class="code" href="class_f_p_d_f.html#d196be21405b44433e08efedf63fcf27">$AutoPageBreak</a>;      <span class="comment">//automatic page breaking</span>
<a name="l00068"></a><a class="code" href="class_f_p_d_f.html#1a0fd03d8f95b0119fed813fe5c980a8">00068</a> var <a class="code" href="class_f_p_d_f.html#1a0fd03d8f95b0119fed813fe5c980a8">$PageBreakTrigger</a>;   <span class="comment">//threshold used to trigger page breaks</span>
<a name="l00069"></a><a class="code" href="class_f_p_d_f.html#d826d8f87302ffc1b53c3af9b32509e2">00069</a> var <a class="code" href="class_f_p_d_f.html#d826d8f87302ffc1b53c3af9b32509e2">$InHeader</a>;           <span class="comment">//flag set when processing header</span>
<a name="l00070"></a><a class="code" href="class_f_p_d_f.html#9550396e618abf65f024fb07b4c31bdd">00070</a> var <a class="code" href="class_f_p_d_f.html#9550396e618abf65f024fb07b4c31bdd">$InFooter</a>;           <span class="comment">//flag set when processing footer</span>
<a name="l00071"></a><a class="code" href="class_f_p_d_f.html#fc97ebf2f645908e261c641fbf48be92">00071</a> var <a class="code" href="class_f_p_d_f.html#fc97ebf2f645908e261c641fbf48be92">$ZoomMode</a>;           <span class="comment">//zoom display mode</span>
<a name="l00072"></a><a class="code" href="class_f_p_d_f.html#8a1b8f011e83924e04fd4868e6a0fd25">00072</a> var <a class="code" href="class_f_p_d_f.html#8a1b8f011e83924e04fd4868e6a0fd25">$LayoutMode</a>;         <span class="comment">//layout display mode</span>
<a name="l00073"></a><a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">00073</a> var <a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">$title</a>;              <span class="comment">//title</span>
<a name="l00074"></a><a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">00074</a> var <a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">$subject</a>;            <span class="comment">//subject</span>
<a name="l00075"></a><a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">00075</a> var <a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">$author</a>;             <span class="comment">//author</span>
<a name="l00076"></a><a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">00076</a> var <a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">$keywords</a>;           <span class="comment">//keywords</span>
<a name="l00077"></a><a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">00077</a> var <a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">$creator</a>;            <span class="comment">//creator</span>
<a name="l00078"></a><a class="code" href="class_f_p_d_f.html#8ca11347db37499aaf473e390db7459b">00078</a> var <a class="code" href="class_f_p_d_f.html#8ca11347db37499aaf473e390db7459b">$AliasNbPages</a>;       <span class="comment">//alias for total number of pages</span>
<a name="l00079"></a><a class="code" href="class_f_p_d_f.html#5d794ad25d8bbf69f42452deb7e1a2be">00079</a> var <a class="code" href="class_f_p_d_f.html#5d794ad25d8bbf69f42452deb7e1a2be">$PDFVersion</a>;         <span class="comment">//PDF version number</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/*******************************************************************************</span>
<a name="l00082"></a>00082 <span class="comment">*                                                                              *</span>
<a name="l00083"></a>00083 <span class="comment">*                               Public methods                                 *</span>
<a name="l00084"></a>00084 <span class="comment">*                                                                              *</span>
<a name="l00085"></a>00085 <span class="comment">*******************************************************************************/</span>
<a name="l00086"></a><a class="code" href="class_f_p_d_f.html#ce32ff3bfbe4d590e410c420e7482bc8">00086</a> function <a class="code" href="class_f_p_d_f.html#ce32ff3bfbe4d590e410c420e7482bc8">FPDF</a>($orientation=<span class="charliteral">'P'</span>, $unit=<span class="stringliteral">'mm'</span>, $format=<span class="stringliteral">'A4'</span>)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088         <span class="comment">//Some checks</span>
<a name="l00089"></a>00089         $this-&gt;<a class="code" href="class_f_p_d_f.html#1ce404a00709a07ca9851b91aefbb0c4">_dochecks</a>();
<a name="l00090"></a>00090         <span class="comment">//Initialization of properties</span>
<a name="l00091"></a>00091         $this-&gt;page=0;
<a name="l00092"></a>00092         $this-&gt;n=2;
<a name="l00093"></a>00093         $this-&gt;buffer=<span class="stringliteral">''</span>;
<a name="l00094"></a>00094         $this-&gt;pages=array();
<a name="l00095"></a>00095         $this-&gt;PageSizes=array();
<a name="l00096"></a>00096         $this-&gt;state=0;
<a name="l00097"></a>00097         $this-&gt;fonts=array();
<a name="l00098"></a>00098         $this-&gt;FontFiles=array();
<a name="l00099"></a>00099         $this-&gt;diffs=array();
<a name="l00100"></a>00100         $this-&gt;images=array();
<a name="l00101"></a>00101         $this-&gt;links=array();
<a name="l00102"></a>00102         $this-&gt;InHeader=<span class="keyword">false</span>;
<a name="l00103"></a>00103         $this-&gt;InFooter=<span class="keyword">false</span>;
<a name="l00104"></a>00104         $this-&gt;lasth=0;
<a name="l00105"></a>00105         $this-&gt;FontFamily=<span class="stringliteral">''</span>;
<a name="l00106"></a>00106         $this-&gt;FontStyle=<span class="stringliteral">''</span>;
<a name="l00107"></a>00107         $this-&gt;FontSizePt=12;
<a name="l00108"></a>00108         $this-&gt;underline=<span class="keyword">false</span>;
<a name="l00109"></a>00109         $this-&gt;DrawColor=<span class="stringliteral">'0 G'</span>;
<a name="l00110"></a>00110         $this-&gt;FillColor=<span class="stringliteral">'0 g'</span>;
<a name="l00111"></a>00111         $this-&gt;TextColor=<span class="stringliteral">'0 g'</span>;
<a name="l00112"></a>00112         $this-&gt;ColorFlag=<span class="keyword">false</span>;
<a name="l00113"></a>00113         $this-&gt;ws=0;
<a name="l00114"></a>00114         <span class="comment">//Standard fonts</span>
<a name="l00115"></a>00115         $this-&gt;CoreFonts=array(<span class="stringliteral">'courier'</span>=&gt;<span class="stringliteral">'Courier'</span>, <span class="stringliteral">'courierB'</span>=&gt;<span class="stringliteral">'Courier-Bold'</span>, <span class="stringliteral">'courierI'</span>=&gt;<span class="stringliteral">'Courier-Oblique'</span>, <span class="stringliteral">'courierBI'</span>=&gt;<span class="stringliteral">'Courier-BoldOblique'</span>,
<a name="l00116"></a>00116                 <span class="stringliteral">'helvetica'</span>=&gt;<span class="stringliteral">'Helvetica'</span>, <span class="stringliteral">'helveticaB'</span>=&gt;<span class="stringliteral">'Helvetica-Bold'</span>, <span class="stringliteral">'helveticaI'</span>=&gt;<span class="stringliteral">'Helvetica-Oblique'</span>, <span class="stringliteral">'helveticaBI'</span>=&gt;<span class="stringliteral">'Helvetica-BoldOblique'</span>,
<a name="l00117"></a>00117                 <span class="stringliteral">'times'</span>=&gt;<span class="stringliteral">'Times-Roman'</span>, <span class="stringliteral">'timesB'</span>=&gt;<span class="stringliteral">'Times-Bold'</span>, <span class="stringliteral">'timesI'</span>=&gt;<span class="stringliteral">'Times-Italic'</span>, <span class="stringliteral">'timesBI'</span>=&gt;<span class="stringliteral">'Times-BoldItalic'</span>,
<a name="l00118"></a>00118                 <span class="stringliteral">'symbol'</span>=&gt;<span class="stringliteral">'Symbol'</span>, <span class="stringliteral">'zapfdingbats'</span>=&gt;<span class="stringliteral">'ZapfDingbats'</span>);
<a name="l00119"></a>00119         <span class="comment">//Scale factor</span>
<a name="l00120"></a>00120         <span class="keywordflow">if</span>($unit==<span class="stringliteral">'pt'</span>)
<a name="l00121"></a>00121                 $this-&gt;k=1;
<a name="l00122"></a>00122         elseif($unit==<span class="stringliteral">'mm'</span>)
<a name="l00123"></a>00123                 $this-&gt;k=72/25.4;
<a name="l00124"></a>00124         elseif($unit==<span class="stringliteral">'cm'</span>)
<a name="l00125"></a>00125                 $this-&gt;k=72/2.54;
<a name="l00126"></a>00126         elseif($unit==<span class="stringliteral">'in'</span>)
<a name="l00127"></a>00127                 $this-&gt;k=72;
<a name="l00128"></a>00128         <span class="keywordflow">else</span>
<a name="l00129"></a>00129                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect unit: '</span>.$unit);
<a name="l00130"></a>00130         <span class="comment">//Page format</span>
<a name="l00131"></a>00131         $this-&gt;PageFormats=array(<span class="stringliteral">'a3'</span>=&gt;array(841.89,1190.55), <span class="stringliteral">'a4'</span>=&gt;array(595.28,841.89), <span class="stringliteral">'a5'</span>=&gt;array(420.94,595.28),
<a name="l00132"></a>00132                 <span class="stringliteral">'letter'</span>=&gt;array(612,792), <span class="stringliteral">'legal'</span>=&gt;array(612,1008));
<a name="l00133"></a>00133         <span class="keywordflow">if</span>(is_string($format))
<a name="l00134"></a>00134                 $format=$this-&gt;<a class="code" href="class_f_p_d_f.html#12b4afff54d10102c052ec8618713df4">_getpageformat</a>($format);
<a name="l00135"></a>00135         $this-&gt;DefPageFormat=$format;
<a name="l00136"></a>00136         $this-&gt;CurPageFormat=$format;
<a name="l00137"></a>00137         <span class="comment">//Page orientation</span>
<a name="l00138"></a>00138         $orientation=strtolower($orientation);
<a name="l00139"></a>00139         <span class="keywordflow">if</span>($orientation==<span class="charliteral">'p'</span> || $orientation==<span class="stringliteral">'portrait'</span>)
<a name="l00140"></a>00140         {
<a name="l00141"></a>00141                 $this-&gt;DefOrientation=<span class="charliteral">'P'</span>;
<a name="l00142"></a>00142                 $this-&gt;w=$this-&gt;DefPageFormat[0];
<a name="l00143"></a>00143                 $this-&gt;h=$this-&gt;DefPageFormat[1];
<a name="l00144"></a>00144         }
<a name="l00145"></a>00145         elseif($orientation==<span class="charliteral">'l'</span> || $orientation==<span class="stringliteral">'landscape'</span>)
<a name="l00146"></a>00146         {
<a name="l00147"></a>00147                 $this-&gt;DefOrientation=<span class="charliteral">'L'</span>;
<a name="l00148"></a>00148                 $this-&gt;w=$this-&gt;DefPageFormat[1];
<a name="l00149"></a>00149                 $this-&gt;h=$this-&gt;DefPageFormat[0];
<a name="l00150"></a>00150         }
<a name="l00151"></a>00151         <span class="keywordflow">else</span>
<a name="l00152"></a>00152                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect orientation: '</span>.$orientation);
<a name="l00153"></a>00153         $this-&gt;CurOrientation=$this-&gt;DefOrientation;
<a name="l00154"></a>00154         $this-&gt;wPt=$this-&gt;w*$this-&gt;k;
<a name="l00155"></a>00155         $this-&gt;hPt=$this-&gt;h*$this-&gt;k;
<a name="l00156"></a>00156         <span class="comment">//Page margins (1 cm)</span>
<a name="l00157"></a>00157         $margin=28.35/$this-&gt;k;
<a name="l00158"></a>00158         $this-&gt;<a class="code" href="class_f_p_d_f.html#03ee8480b6a0b9362820d225c309f603">SetMargins</a>($margin,$margin);
<a name="l00159"></a>00159         <span class="comment">//Interior cell margin (1 mm)</span>
<a name="l00160"></a>00160         $this-&gt;cMargin=$margin/10;
<a name="l00161"></a>00161         <span class="comment">//Line width (0.2 mm)</span>
<a name="l00162"></a>00162         $this-&gt;LineWidth=.567/$this-&gt;k;
<a name="l00163"></a>00163         <span class="comment">//Automatic page break</span>
<a name="l00164"></a>00164         $this-&gt;<a class="code" href="class_f_p_d_f.html#55c2e62a11e10dd7bc0c8aa089ba1c5e">SetAutoPageBreak</a>(<span class="keyword">true</span>,2*$margin);
<a name="l00165"></a>00165         <span class="comment">//Full width display mode</span>
<a name="l00166"></a>00166         $this-&gt;<a class="code" href="class_f_p_d_f.html#c02bedcdaf4994b3850fb3f20689fa5d">SetDisplayMode</a>(<span class="stringliteral">'fullwidth'</span>);
<a name="l00167"></a>00167         <span class="comment">//Enable compression</span>
<a name="l00168"></a>00168         $this-&gt;<a class="code" href="class_f_p_d_f.html#b56cc065fff6c44c473c7f0428876486">SetCompression</a>(<span class="keyword">true</span>);
<a name="l00169"></a>00169         <span class="comment">//Set default PDF version number</span>
<a name="l00170"></a>00170         $this-&gt;PDFVersion=<span class="stringliteral">'1.3'</span>;
<a name="l00171"></a>00171 }
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="class_f_p_d_f.html#03ee8480b6a0b9362820d225c309f603">00173</a> function <a class="code" href="class_f_p_d_f.html#03ee8480b6a0b9362820d225c309f603">SetMargins</a>($left, $top, $right=null)
<a name="l00174"></a>00174 {
<a name="l00175"></a>00175         <span class="comment">//Set left, top and right margins</span>
<a name="l00176"></a>00176         $this-&gt;lMargin=$left;
<a name="l00177"></a>00177         $this-&gt;tMargin=$top;
<a name="l00178"></a>00178         <span class="keywordflow">if</span>($right===null)
<a name="l00179"></a>00179                 $right=$left;
<a name="l00180"></a>00180         $this-&gt;rMargin=$right;
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="class_f_p_d_f.html#64306dab17b5156dbb09151818ebf98b">00183</a> function <a class="code" href="class_f_p_d_f.html#64306dab17b5156dbb09151818ebf98b">SetLeftMargin</a>($margin)
<a name="l00184"></a>00184 {
<a name="l00185"></a>00185         <span class="comment">//Set left margin</span>
<a name="l00186"></a>00186         $this-&gt;lMargin=$margin;
<a name="l00187"></a>00187         <span class="keywordflow">if</span>($this-&gt;page&gt;0 &amp;&amp; $this-&gt;x&lt;$margin)
<a name="l00188"></a>00188                 $this-&gt;x=$margin;
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="class_f_p_d_f.html#eb7511c3d686e2aa9f9496f1b1ec147f">00191</a> function <a class="code" href="class_f_p_d_f.html#eb7511c3d686e2aa9f9496f1b1ec147f">SetTopMargin</a>($margin)
<a name="l00192"></a>00192 {
<a name="l00193"></a>00193         <span class="comment">//Set top margin</span>
<a name="l00194"></a>00194         $this-&gt;tMargin=$margin;
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="class_f_p_d_f.html#1008ef2dbf448c60dd2f9324bcc6601a">00197</a> function <a class="code" href="class_f_p_d_f.html#1008ef2dbf448c60dd2f9324bcc6601a">SetRightMargin</a>($margin)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199         <span class="comment">//Set right margin</span>
<a name="l00200"></a>00200         $this-&gt;rMargin=$margin;
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_f_p_d_f.html#55c2e62a11e10dd7bc0c8aa089ba1c5e">00203</a> function <a class="code" href="class_f_p_d_f.html#55c2e62a11e10dd7bc0c8aa089ba1c5e">SetAutoPageBreak</a>($auto, $margin=0)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205         <span class="comment">//Set auto page break mode and triggering margin</span>
<a name="l00206"></a>00206         $this-&gt;AutoPageBreak=$auto;
<a name="l00207"></a>00207         $this-&gt;bMargin=$margin;
<a name="l00208"></a>00208         $this-&gt;PageBreakTrigger=$this-&gt;h-$margin;
<a name="l00209"></a>00209 }
<a name="l00210"></a>00210 
<a name="l00211"></a><a class="code" href="class_f_p_d_f.html#c02bedcdaf4994b3850fb3f20689fa5d">00211</a> function <a class="code" href="class_f_p_d_f.html#c02bedcdaf4994b3850fb3f20689fa5d">SetDisplayMode</a>($zoom, $layout=<span class="stringliteral">'continuous'</span>)
<a name="l00212"></a>00212 {
<a name="l00213"></a>00213         <span class="comment">//Set display mode in viewer</span>
<a name="l00214"></a>00214         <span class="keywordflow">if</span>($zoom==<span class="stringliteral">'fullpage'</span> || $zoom==<span class="stringliteral">'fullwidth'</span> || $zoom==<span class="stringliteral">'real'</span> || $zoom==<span class="stringliteral">'default'</span> || !is_string($zoom))
<a name="l00215"></a>00215                 $this-&gt;ZoomMode=$zoom;
<a name="l00216"></a>00216         <span class="keywordflow">else</span>
<a name="l00217"></a>00217                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect zoom display mode: '</span>.$zoom);
<a name="l00218"></a>00218         <span class="keywordflow">if</span>($layout==<span class="stringliteral">'single'</span> || $layout==<span class="stringliteral">'continuous'</span> || $layout==<span class="stringliteral">'two'</span> || $layout==<span class="stringliteral">'default'</span>)
<a name="l00219"></a>00219                 $this-&gt;LayoutMode=$layout;
<a name="l00220"></a>00220         <span class="keywordflow">else</span>
<a name="l00221"></a>00221                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect layout display mode: '</span>.$layout);
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="class_f_p_d_f.html#b56cc065fff6c44c473c7f0428876486">00224</a> function <a class="code" href="class_f_p_d_f.html#b56cc065fff6c44c473c7f0428876486">SetCompression</a>(<a class="code" href="class_f_p_d_f.html#6effca6f281458983c61647878f6dc18">$compress</a>)
<a name="l00225"></a>00225 {
<a name="l00226"></a>00226         <span class="comment">//Set page compression</span>
<a name="l00227"></a>00227         <span class="keywordflow">if</span>(function_exists(<span class="stringliteral">'gzcompress'</span>))
<a name="l00228"></a>00228                 $this-&gt;compress=<a class="code" href="class_f_p_d_f.html#6effca6f281458983c61647878f6dc18">$compress</a>;
<a name="l00229"></a>00229         <span class="keywordflow">else</span>
<a name="l00230"></a>00230                 $this-&gt;compress=<span class="keyword">false</span>;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="class_f_p_d_f.html#8a8a4c77944aae4ac0219fefbe53b494">00233</a> function <a class="code" href="class_f_p_d_f.html#8a8a4c77944aae4ac0219fefbe53b494">SetTitle</a>(<a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">$title</a>, $isUTF8=<span class="keyword">false</span>)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235         <span class="comment">//Title of document</span>
<a name="l00236"></a>00236         <span class="keywordflow">if</span>($isUTF8)
<a name="l00237"></a>00237                 <a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">$title</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>(<a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">$title</a>);
<a name="l00238"></a>00238         $this-&gt;title=<a class="code" href="class_f_p_d_f.html#1a9653841a04eab8f7792dc620ad768f">$title</a>;
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="class_f_p_d_f.html#29e614b472d76809a7f24d8382b2aec8">00241</a> function <a class="code" href="class_f_p_d_f.html#29e614b472d76809a7f24d8382b2aec8">SetSubject</a>(<a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">$subject</a>, $isUTF8=<span class="keyword">false</span>)
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243         <span class="comment">//Subject of document</span>
<a name="l00244"></a>00244         <span class="keywordflow">if</span>($isUTF8)
<a name="l00245"></a>00245                 <a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">$subject</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>(<a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">$subject</a>);
<a name="l00246"></a>00246         $this-&gt;subject=<a class="code" href="class_f_p_d_f.html#01809a20cac7b1b9123141262ac881e2">$subject</a>;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="class_f_p_d_f.html#2448f729ffdee950dca638910a31a206">00249</a> function <a class="code" href="class_f_p_d_f.html#2448f729ffdee950dca638910a31a206">SetAuthor</a>(<a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">$author</a>, $isUTF8=<span class="keyword">false</span>)
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251         <span class="comment">//Author of document</span>
<a name="l00252"></a>00252         <span class="keywordflow">if</span>($isUTF8)
<a name="l00253"></a>00253                 <a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">$author</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>(<a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">$author</a>);
<a name="l00254"></a>00254         $this-&gt;author=<a class="code" href="class_f_p_d_f.html#0fd364189356e647c1e12ff1d264b292">$author</a>;
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="class_f_p_d_f.html#97c034e7f4c04395a54f09f582544a97">00257</a> function <a class="code" href="class_f_p_d_f.html#97c034e7f4c04395a54f09f582544a97">SetKeywords</a>(<a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">$keywords</a>, $isUTF8=<span class="keyword">false</span>)
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259         <span class="comment">//Keywords of document</span>
<a name="l00260"></a>00260         <span class="keywordflow">if</span>($isUTF8)
<a name="l00261"></a>00261                 <a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">$keywords</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>(<a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">$keywords</a>);
<a name="l00262"></a>00262         $this-&gt;keywords=<a class="code" href="class_f_p_d_f.html#f911783b120fbaaebdad50473826a43a">$keywords</a>;
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="class_f_p_d_f.html#d528c02fc9104993d5b8c4d3f4a5ae00">00265</a> function <a class="code" href="class_f_p_d_f.html#d528c02fc9104993d5b8c4d3f4a5ae00">SetCreator</a>(<a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">$creator</a>, $isUTF8=<span class="keyword">false</span>)
<a name="l00266"></a>00266 {
<a name="l00267"></a>00267         <span class="comment">//Creator of document</span>
<a name="l00268"></a>00268         <span class="keywordflow">if</span>($isUTF8)
<a name="l00269"></a>00269                 <a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">$creator</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>(<a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">$creator</a>);
<a name="l00270"></a>00270         $this-&gt;creator=<a class="code" href="class_f_p_d_f.html#8e24c7db53f08092a8038d7aa7d07a48">$creator</a>;
<a name="l00271"></a>00271 }
<a name="l00272"></a>00272 
<a name="l00273"></a><a class="code" href="class_f_p_d_f.html#519cf01024f5981364ec7cd2d5281253">00273</a> function <a class="code" href="class_f_p_d_f.html#519cf01024f5981364ec7cd2d5281253">AliasNbPages</a>($alias=<span class="stringliteral">'{nb}'</span>)
<a name="l00274"></a>00274 {
<a name="l00275"></a>00275         <span class="comment">//Define an alias for total number of pages</span>
<a name="l00276"></a>00276         $this-&gt;<a class="code" href="class_f_p_d_f.html#519cf01024f5981364ec7cd2d5281253">AliasNbPages</a>=$alias;
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">00279</a> function <a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>($msg)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281         <span class="comment">//Fatal error</span>
<a name="l00282"></a>00282         die(<span class="stringliteral">'&lt;b&gt;FPDF error:&lt;/b&gt; '</span>.$msg);
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="class_f_p_d_f.html#6361408b654aa8ec619489c600492893">00285</a> function <a class="code" href="class_f_p_d_f.html#6361408b654aa8ec619489c600492893">Open</a>()
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287         <span class="comment">//Begin document</span>
<a name="l00288"></a>00288         $this-&gt;state=1;
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="class_f_p_d_f.html#f6bcdd2acb114191b61065e85ff0b62c">00291</a> function <a class="code" href="class_f_p_d_f.html#f6bcdd2acb114191b61065e85ff0b62c">Close</a>()
<a name="l00292"></a>00292 {
<a name="l00293"></a>00293         <span class="comment">//Terminate document</span>
<a name="l00294"></a>00294         <span class="keywordflow">if</span>($this-&gt;state==3)
<a name="l00295"></a>00295                 <span class="keywordflow">return</span>;
<a name="l00296"></a>00296         <span class="keywordflow">if</span>($this-&gt;page==0)
<a name="l00297"></a>00297                 $this-&gt;<a class="code" href="class_f_p_d_f.html#24a18568a42d88b3db53f9cd46ef8694">AddPage</a>();
<a name="l00298"></a>00298         <span class="comment">//Page footer</span>
<a name="l00299"></a>00299         $this-&gt;InFooter=<span class="keyword">true</span>;
<a name="l00300"></a>00300         $this-&gt;<a class="code" href="class_f_p_d_f.html#aa8da01869c5e5a75ff9150016dad08d">Footer</a>();
<a name="l00301"></a>00301         $this-&gt;InFooter=<span class="keyword">false</span>;
<a name="l00302"></a>00302         <span class="comment">//Close page</span>
<a name="l00303"></a>00303         $this-&gt;<a class="code" href="class_f_p_d_f.html#0c727a46d970b65e123da12e3cb34b58">_endpage</a>();
<a name="l00304"></a>00304         <span class="comment">//Close document</span>
<a name="l00305"></a>00305         $this-&gt;<a class="code" href="class_f_p_d_f.html#5872b1a94bcd6c00a0bdd2ece02409ac">_enddoc</a>();
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a><a class="code" href="class_f_p_d_f.html#24a18568a42d88b3db53f9cd46ef8694">00308</a> function <a class="code" href="class_f_p_d_f.html#24a18568a42d88b3db53f9cd46ef8694">AddPage</a>($orientation=<span class="stringliteral">''</span>, $format=<span class="stringliteral">''</span>)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310         <span class="comment">//Start a new page</span>
<a name="l00311"></a>00311         <span class="keywordflow">if</span>($this-&gt;state==0)
<a name="l00312"></a>00312                 $this-&gt;<a class="code" href="class_f_p_d_f.html#6361408b654aa8ec619489c600492893">Open</a>();
<a name="l00313"></a>00313         $family=$this-&gt;FontFamily;
<a name="l00314"></a>00314         $style=$this-&gt;FontStyle.($this-&gt;underline ? <span class="charliteral">'U'</span> : <span class="stringliteral">''</span>);
<a name="l00315"></a>00315         $size=$this-&gt;FontSizePt;
<a name="l00316"></a>00316         $lw=$this-&gt;LineWidth;
<a name="l00317"></a>00317         $dc=$this-&gt;DrawColor;
<a name="l00318"></a>00318         $fc=$this-&gt;FillColor;
<a name="l00319"></a>00319         $tc=$this-&gt;TextColor;
<a name="l00320"></a>00320         $cf=$this-&gt;ColorFlag;
<a name="l00321"></a>00321         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00322"></a>00322         {
<a name="l00323"></a>00323                 <span class="comment">//Page footer</span>
<a name="l00324"></a>00324                 $this-&gt;InFooter=<span class="keyword">true</span>;
<a name="l00325"></a>00325                 $this-&gt;<a class="code" href="class_f_p_d_f.html#aa8da01869c5e5a75ff9150016dad08d">Footer</a>();
<a name="l00326"></a>00326                 $this-&gt;InFooter=<span class="keyword">false</span>;
<a name="l00327"></a>00327                 <span class="comment">//Close page</span>
<a name="l00328"></a>00328                 $this-&gt;<a class="code" href="class_f_p_d_f.html#0c727a46d970b65e123da12e3cb34b58">_endpage</a>();
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330         <span class="comment">//Start new page</span>
<a name="l00331"></a>00331         $this-&gt;<a class="code" href="class_f_p_d_f.html#4a539c5d31c9caf6ff6674d0621e2ce6">_beginpage</a>($orientation,$format);
<a name="l00332"></a>00332         <span class="comment">//Set line cap style to square</span>
<a name="l00333"></a>00333         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(<span class="stringliteral">'2 J'</span>);
<a name="l00334"></a>00334         <span class="comment">//Set line width</span>
<a name="l00335"></a>00335         $this-&gt;LineWidth=$lw;
<a name="l00336"></a>00336         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.2F w'</span>,$lw*$this-&gt;k));
<a name="l00337"></a>00337         <span class="comment">//Set font</span>
<a name="l00338"></a>00338         <span class="keywordflow">if</span>($family)
<a name="l00339"></a>00339                 $this-&gt;<a class="code" href="class_f_p_d_f.html#82acf7b1322a634829b56bb209045e1c">SetFont</a>($family,$style,$size);
<a name="l00340"></a>00340         <span class="comment">//Set colors</span>
<a name="l00341"></a>00341         $this-&gt;DrawColor=$dc;
<a name="l00342"></a>00342         <span class="keywordflow">if</span>($dc!=<span class="stringliteral">'0 G'</span>)
<a name="l00343"></a>00343                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($dc);
<a name="l00344"></a>00344         $this-&gt;FillColor=$fc;
<a name="l00345"></a>00345         <span class="keywordflow">if</span>($fc!=<span class="stringliteral">'0 g'</span>)
<a name="l00346"></a>00346                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($fc);
<a name="l00347"></a>00347         $this-&gt;TextColor=$tc;
<a name="l00348"></a>00348         $this-&gt;ColorFlag=$cf;
<a name="l00349"></a>00349         <span class="comment">//Page header</span>
<a name="l00350"></a>00350         $this-&gt;InHeader=<span class="keyword">true</span>;
<a name="l00351"></a>00351         $this-&gt;<a class="code" href="class_f_p_d_f.html#b1bedba6d1753b9e3f18ed3820743fd6">Header</a>();
<a name="l00352"></a>00352         $this-&gt;InHeader=<span class="keyword">false</span>;
<a name="l00353"></a>00353         <span class="comment">//Restore line width</span>
<a name="l00354"></a>00354         <span class="keywordflow">if</span>($this-&gt;LineWidth!=$lw)
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356                 $this-&gt;LineWidth=$lw;
<a name="l00357"></a>00357                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.2F w'</span>,$lw*$this-&gt;k));
<a name="l00358"></a>00358         }
<a name="l00359"></a>00359         <span class="comment">//Restore font</span>
<a name="l00360"></a>00360         <span class="keywordflow">if</span>($family)
<a name="l00361"></a>00361                 $this-&gt;<a class="code" href="class_f_p_d_f.html#82acf7b1322a634829b56bb209045e1c">SetFont</a>($family,$style,$size);
<a name="l00362"></a>00362         <span class="comment">//Restore colors</span>
<a name="l00363"></a>00363         <span class="keywordflow">if</span>($this-&gt;DrawColor!=$dc)
<a name="l00364"></a>00364         {
<a name="l00365"></a>00365                 $this-&gt;DrawColor=$dc;
<a name="l00366"></a>00366                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($dc);
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368         <span class="keywordflow">if</span>($this-&gt;FillColor!=$fc)
<a name="l00369"></a>00369         {
<a name="l00370"></a>00370                 $this-&gt;FillColor=$fc;
<a name="l00371"></a>00371                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($fc);
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373         $this-&gt;TextColor=$tc;
<a name="l00374"></a>00374         $this-&gt;ColorFlag=$cf;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="class_f_p_d_f.html#b1bedba6d1753b9e3f18ed3820743fd6">00377</a> function <a class="code" href="class_f_p_d_f.html#b1bedba6d1753b9e3f18ed3820743fd6">Header</a>()
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379         <span class="comment">//To be implemented in your own inherited class</span>
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="class_f_p_d_f.html#aa8da01869c5e5a75ff9150016dad08d">00382</a> function <a class="code" href="class_f_p_d_f.html#aa8da01869c5e5a75ff9150016dad08d">Footer</a>()
<a name="l00383"></a>00383 {
<a name="l00384"></a>00384         <span class="comment">//To be implemented in your own inherited class</span>
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 
<a name="l00387"></a><a class="code" href="class_f_p_d_f.html#f97a0239f79f597b5c88cc68b385f7af">00387</a> function <a class="code" href="class_f_p_d_f.html#f97a0239f79f597b5c88cc68b385f7af">PageNo</a>()
<a name="l00388"></a>00388 {
<a name="l00389"></a>00389         <span class="comment">//Get current page number</span>
<a name="l00390"></a>00390         <span class="keywordflow">return</span> $this-&gt;page;
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="class_f_p_d_f.html#2699cc6ff46c7cf2953e5e740f456d75">00393</a> function <a class="code" href="class_f_p_d_f.html#2699cc6ff46c7cf2953e5e740f456d75">SetDrawColor</a>($r, $g=null, $b=null)
<a name="l00394"></a>00394 {
<a name="l00395"></a>00395         <span class="comment">//Set color for all stroking operations</span>
<a name="l00396"></a>00396         <span class="keywordflow">if</span>(($r==0 &amp;&amp; $g==0 &amp;&amp; $b==0) || $g===null)
<a name="l00397"></a>00397                 $this-&gt;DrawColor=sprintf(<span class="stringliteral">'%.3F G'</span>,$r/255);
<a name="l00398"></a>00398         <span class="keywordflow">else</span>
<a name="l00399"></a>00399                 $this-&gt;DrawColor=sprintf(<span class="stringliteral">'%.3F %.3F %.3F RG'</span>,$r/255,$g/255,$b/255);
<a name="l00400"></a>00400         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00401"></a>00401                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($this-&gt;DrawColor);
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="class_f_p_d_f.html#c01941b00b99afca24dec97591665a3c">00404</a> function <a class="code" href="class_f_p_d_f.html#c01941b00b99afca24dec97591665a3c">SetFillColor</a>($r, $g=null, $b=null)
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406         <span class="comment">//Set color for all filling operations</span>
<a name="l00407"></a>00407         <span class="keywordflow">if</span>(($r==0 &amp;&amp; $g==0 &amp;&amp; $b==0) || $g===null)
<a name="l00408"></a>00408                 $this-&gt;FillColor=sprintf(<span class="stringliteral">'%.3F g'</span>,$r/255);
<a name="l00409"></a>00409         <span class="keywordflow">else</span>
<a name="l00410"></a>00410                 $this-&gt;FillColor=sprintf(<span class="stringliteral">'%.3F %.3F %.3F rg'</span>,$r/255,$g/255,$b/255);
<a name="l00411"></a>00411         $this-&gt;ColorFlag=($this-&gt;FillColor!=$this-&gt;TextColor);
<a name="l00412"></a>00412         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00413"></a>00413                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($this-&gt;FillColor);
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
<a name="l00416"></a><a class="code" href="class_f_p_d_f.html#59f12883ff2b60013eb0fe2c8c7e2dd5">00416</a> function <a class="code" href="class_f_p_d_f.html#59f12883ff2b60013eb0fe2c8c7e2dd5">SetTextColor</a>($r, $g=null, $b=null)
<a name="l00417"></a>00417 {
<a name="l00418"></a>00418         <span class="comment">//Set color for text</span>
<a name="l00419"></a>00419         <span class="keywordflow">if</span>(($r==0 &amp;&amp; $g==0 &amp;&amp; $b==0) || $g===null)
<a name="l00420"></a>00420                 $this-&gt;TextColor=sprintf(<span class="stringliteral">'%.3F g'</span>,$r/255);
<a name="l00421"></a>00421         <span class="keywordflow">else</span>
<a name="l00422"></a>00422                 $this-&gt;TextColor=sprintf(<span class="stringliteral">'%.3F %.3F %.3F rg'</span>,$r/255,$g/255,$b/255);
<a name="l00423"></a>00423         $this-&gt;ColorFlag=($this-&gt;FillColor!=$this-&gt;TextColor);
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
<a name="l00426"></a><a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">00426</a> function <a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">GetStringWidth</a>($s)
<a name="l00427"></a>00427 {
<a name="l00428"></a>00428         <span class="comment">//Get width of a string in the current font</span>
<a name="l00429"></a>00429         $s=(string)$s;
<a name="l00430"></a>00430         $cw=&amp;$this-&gt;CurrentFont[<span class="stringliteral">'cw'</span>];
<a name="l00431"></a>00431         <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=0;
<a name="l00432"></a>00432         $l=strlen($s);
<a name="l00433"></a>00433         <span class="keywordflow">for</span>($i=0;$i&lt;$l;$i++)
<a name="l00434"></a>00434                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>+=$cw[$s[$i]];
<a name="l00435"></a>00435         <span class="keywordflow">return</span> <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$this-&gt;FontSize/1000;
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 
<a name="l00438"></a><a class="code" href="class_f_p_d_f.html#c8e8290a814b06303c1dfff06ee24acb">00438</a> function <a class="code" href="class_f_p_d_f.html#c8e8290a814b06303c1dfff06ee24acb">SetLineWidth</a>($width)
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440         <span class="comment">//Set line width</span>
<a name="l00441"></a>00441         $this-&gt;LineWidth=$width;
<a name="l00442"></a>00442         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00443"></a>00443                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.2F w'</span>,$width*$this-&gt;k));
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="class_f_p_d_f.html#408bfb653ed942e1e00d80ea9cdc139b">00446</a> function <a class="code" href="class_f_p_d_f.html#408bfb653ed942e1e00d80ea9cdc139b">Line</a>($x1, $y1, $x2, $y2)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448         <span class="comment">//Draw a line</span>
<a name="l00449"></a>00449         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.2F %.2F m %.2F %.2F l S'</span>,$x1*$this-&gt;k,($this-&gt;h-$y1)*$this-&gt;k,$x2*$this-&gt;k,($this-&gt;h-$y2)*$this-&gt;k));
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="class_f_p_d_f.html#f6b45f243c32ec04f1be28823b0cf15c">00452</a> function <a class="code" href="class_f_p_d_f.html#f6b45f243c32ec04f1be28823b0cf15c">Rect</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>, <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>, $style=<span class="stringliteral">''</span>)
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454         <span class="comment">//Draw a rectangle</span>
<a name="l00455"></a>00455         <span class="keywordflow">if</span>($style==<span class="charliteral">'F'</span>)
<a name="l00456"></a>00456                 $op=<span class="charliteral">'f'</span>;
<a name="l00457"></a>00457         elseif($style==<span class="stringliteral">'FD'</span> || $style==<span class="stringliteral">'DF'</span>)
<a name="l00458"></a>00458                 $op=<span class="charliteral">'B'</span>;
<a name="l00459"></a>00459         <span class="keywordflow">else</span>
<a name="l00460"></a>00460                 $op=<span class="charliteral">'S'</span>;
<a name="l00461"></a>00461         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.2F %.2F %.2F %.2F re %s'</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$this-&gt;k,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$this-&gt;k,<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$this-&gt;k,-<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>*$this-&gt;k,$op));
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="class_f_p_d_f.html#7bfe3e0ed15ed966d8c41e36fb16553c">00464</a> function <a class="code" href="class_f_p_d_f.html#7bfe3e0ed15ed966d8c41e36fb16553c">AddFont</a>($family, $style=<span class="stringliteral">''</span>, $file=<span class="stringliteral">''</span>)
<a name="l00465"></a>00465 {
<a name="l00466"></a>00466         <span class="comment">//Add a TrueType or Type1 font</span>
<a name="l00467"></a>00467         $family=strtolower($family);
<a name="l00468"></a>00468         <span class="keywordflow">if</span>($file==<span class="stringliteral">''</span>)
<a name="l00469"></a>00469                 $file=str_replace(<span class="charliteral">' '</span>,<span class="stringliteral">''</span>,$family).strtolower($style).<span class="stringliteral">'.php'</span>;
<a name="l00470"></a>00470         <span class="keywordflow">if</span>($family==<span class="stringliteral">'arial'</span>)
<a name="l00471"></a>00471                 $family=<span class="stringliteral">'helvetica'</span>;
<a name="l00472"></a>00472         $style=strtoupper($style);
<a name="l00473"></a>00473         <span class="keywordflow">if</span>($style==<span class="stringliteral">'IB'</span>)
<a name="l00474"></a>00474                 $style=<span class="stringliteral">'BI'</span>;
<a name="l00475"></a>00475         $fontkey=$family.$style;
<a name="l00476"></a>00476         <span class="keywordflow">if</span>(isset($this-&gt;fonts[$fontkey]))
<a name="l00477"></a>00477                 <span class="keywordflow">return</span>;
<a name="l00478"></a>00478         include($this-&gt;<a class="code" href="class_f_p_d_f.html#85f08b8bb203ef7d3759f5d1cbd83f82">_getfontpath</a>().$file);
<a name="l00479"></a>00479         <span class="keywordflow">if</span>(!isset($name))
<a name="l00480"></a>00480                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Could not include font definition file'</span>);
<a name="l00481"></a>00481         $i=count($this-&gt;fonts)+1;
<a name="l00482"></a>00482         $this-&gt;fonts[$fontkey]=array(<span class="charliteral">'i'</span>=&gt;$i, <span class="stringliteral">'type'</span>=&gt;$type, <span class="stringliteral">'name'</span>=&gt;$name, <span class="stringliteral">'desc'</span>=&gt;$desc, <span class="stringliteral">'up'</span>=&gt;$up, <span class="stringliteral">'ut'</span>=&gt;$ut, <span class="stringliteral">'cw'</span>=&gt;$cw, <span class="stringliteral">'enc'</span>=&gt;$enc, <span class="stringliteral">'file'</span>=&gt;$file);
<a name="l00483"></a>00483         <span class="keywordflow">if</span>($diff)
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485                 <span class="comment">//Search existing encodings</span>
<a name="l00486"></a>00486                 $d=0;
<a name="l00487"></a>00487                 $nb=count($this-&gt;diffs);
<a name="l00488"></a>00488                 <span class="keywordflow">for</span>($i=1;$i&lt;=$nb;$i++)
<a name="l00489"></a>00489                 {
<a name="l00490"></a>00490                         <span class="keywordflow">if</span>($this-&gt;diffs[$i]==$diff)
<a name="l00491"></a>00491                         {
<a name="l00492"></a>00492                                 $d=$i;
<a name="l00493"></a>00493                                 <span class="keywordflow">break</span>;
<a name="l00494"></a>00494                         }
<a name="l00495"></a>00495                 }
<a name="l00496"></a>00496                 <span class="keywordflow">if</span>($d==0)
<a name="l00497"></a>00497                 {
<a name="l00498"></a>00498                         $d=$nb+1;
<a name="l00499"></a>00499                         $this-&gt;diffs[$d]=$diff;
<a name="l00500"></a>00500                 }
<a name="l00501"></a>00501                 $this-&gt;fonts[$fontkey][<span class="stringliteral">'diff'</span>]=$d;
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503         <span class="keywordflow">if</span>($file)
<a name="l00504"></a>00504         {
<a name="l00505"></a>00505                 <span class="keywordflow">if</span>($type==<span class="stringliteral">'TrueType'</span>)
<a name="l00506"></a>00506                         $this-&gt;FontFiles[$file]=array(<span class="stringliteral">'length1'</span>=&gt;$originalsize);
<a name="l00507"></a>00507                 <span class="keywordflow">else</span>
<a name="l00508"></a>00508                         $this-&gt;FontFiles[$file]=array(<span class="stringliteral">'length1'</span>=&gt;$size1, <span class="stringliteral">'length2'</span>=&gt;$size2);
<a name="l00509"></a>00509         }
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="class_f_p_d_f.html#82acf7b1322a634829b56bb209045e1c">00512</a> function <a class="code" href="class_f_p_d_f.html#82acf7b1322a634829b56bb209045e1c">SetFont</a>($family, $style=<span class="stringliteral">''</span>, $size=0)
<a name="l00513"></a>00513 {
<a name="l00514"></a>00514         <span class="comment">//Select a font; size given in points</span>
<a name="l00515"></a>00515         global <a class="code" href="courier_8php.html#191dba904071eb8ce58aee4c4cb6eefd">$fpdf_charwidths</a>;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         $family=strtolower($family);
<a name="l00518"></a>00518         <span class="keywordflow">if</span>($family==<span class="stringliteral">''</span>)
<a name="l00519"></a>00519                 $family=$this-&gt;FontFamily;
<a name="l00520"></a>00520         <span class="keywordflow">if</span>($family==<span class="stringliteral">'arial'</span>)
<a name="l00521"></a>00521                 $family=<span class="stringliteral">'helvetica'</span>;
<a name="l00522"></a>00522         elseif($family==<span class="stringliteral">'symbol'</span> || $family==<span class="stringliteral">'zapfdingbats'</span>)
<a name="l00523"></a>00523                 $style=<span class="stringliteral">''</span>;
<a name="l00524"></a>00524         $style=strtoupper($style);
<a name="l00525"></a>00525         <span class="keywordflow">if</span>(strpos($style,<span class="charliteral">'U'</span>)!==<span class="keyword">false</span>)
<a name="l00526"></a>00526         {
<a name="l00527"></a>00527                 $this-&gt;underline=<span class="keyword">true</span>;
<a name="l00528"></a>00528                 $style=str_replace(<span class="charliteral">'U'</span>,<span class="stringliteral">''</span>,$style);
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530         <span class="keywordflow">else</span>
<a name="l00531"></a>00531                 $this-&gt;underline=<span class="keyword">false</span>;
<a name="l00532"></a>00532         <span class="keywordflow">if</span>($style==<span class="stringliteral">'IB'</span>)
<a name="l00533"></a>00533                 $style=<span class="stringliteral">'BI'</span>;
<a name="l00534"></a>00534         <span class="keywordflow">if</span>($size==0)
<a name="l00535"></a>00535                 $size=$this-&gt;FontSizePt;
<a name="l00536"></a>00536         <span class="comment">//Test if font is already selected</span>
<a name="l00537"></a>00537         <span class="keywordflow">if</span>($this-&gt;FontFamily==$family &amp;&amp; $this-&gt;FontStyle==$style &amp;&amp; $this-&gt;FontSizePt==$size)
<a name="l00538"></a>00538                 <span class="keywordflow">return</span>;
<a name="l00539"></a>00539         <span class="comment">//Test if used for the first time</span>
<a name="l00540"></a>00540         $fontkey=$family.$style;
<a name="l00541"></a>00541         <span class="keywordflow">if</span>(!isset($this-&gt;fonts[$fontkey]))
<a name="l00542"></a>00542         {
<a name="l00543"></a>00543                 <span class="comment">//Check if one of the standard fonts</span>
<a name="l00544"></a>00544                 <span class="keywordflow">if</span>(isset($this-&gt;CoreFonts[$fontkey]))
<a name="l00545"></a>00545                 {
<a name="l00546"></a>00546                         <span class="keywordflow">if</span>(!isset($fpdf_charwidths[$fontkey]))
<a name="l00547"></a>00547                         {
<a name="l00548"></a>00548                                 <span class="comment">//Load metric file</span>
<a name="l00549"></a>00549                                 $file=$family;
<a name="l00550"></a>00550                                 <span class="keywordflow">if</span>($family==<span class="stringliteral">'times'</span> || $family==<span class="stringliteral">'helvetica'</span>)
<a name="l00551"></a>00551                                         $file.=strtolower($style);
<a name="l00552"></a>00552                                 include($this-&gt;<a class="code" href="class_f_p_d_f.html#85f08b8bb203ef7d3759f5d1cbd83f82">_getfontpath</a>().$file.<span class="stringliteral">'.php'</span>);
<a name="l00553"></a>00553                                 <span class="keywordflow">if</span>(!isset($fpdf_charwidths[$fontkey]))
<a name="l00554"></a>00554                                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Could not include font metric file'</span>);
<a name="l00555"></a>00555                         }
<a name="l00556"></a>00556                         $i=count($this-&gt;fonts)+1;
<a name="l00557"></a>00557                         $name=$this-&gt;CoreFonts[$fontkey];
<a name="l00558"></a>00558                         $cw=$fpdf_charwidths[$fontkey];
<a name="l00559"></a>00559                         $this-&gt;fonts[$fontkey]=array(<span class="charliteral">'i'</span>=&gt;$i, <span class="stringliteral">'type'</span>=&gt;<span class="stringliteral">'core'</span>, <span class="stringliteral">'name'</span>=&gt;$name, <span class="stringliteral">'up'</span>=&gt;-100, <span class="stringliteral">'ut'</span>=&gt;50, <span class="stringliteral">'cw'</span>=&gt;$cw);
<a name="l00560"></a>00560                 }
<a name="l00561"></a>00561                 <span class="keywordflow">else</span>
<a name="l00562"></a>00562                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Undefined font: '</span>.$family.<span class="charliteral">' '</span>.$style);
<a name="l00563"></a>00563         }
<a name="l00564"></a>00564         <span class="comment">//Select it</span>
<a name="l00565"></a>00565         $this-&gt;FontFamily=$family;
<a name="l00566"></a>00566         $this-&gt;FontStyle=$style;
<a name="l00567"></a>00567         $this-&gt;FontSizePt=$size;
<a name="l00568"></a>00568         $this-&gt;FontSize=$size/$this-&gt;k;
<a name="l00569"></a>00569         $this-&gt;CurrentFont=&amp;$this-&gt;fonts[$fontkey];
<a name="l00570"></a>00570         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00571"></a>00571                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'BT /F%d %.2F Tf ET'</span>,$this-&gt;CurrentFont[<span class="charliteral">'i'</span>],$this-&gt;FontSizePt));
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="class_f_p_d_f.html#47d041deb672f69250c936a234eead14">00574</a> function <a class="code" href="class_f_p_d_f.html#47d041deb672f69250c936a234eead14">SetFontSize</a>($size)
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576         <span class="comment">//Set font size in points</span>
<a name="l00577"></a>00577         <span class="keywordflow">if</span>($this-&gt;FontSizePt==$size)
<a name="l00578"></a>00578                 <span class="keywordflow">return</span>;
<a name="l00579"></a>00579         $this-&gt;FontSizePt=$size;
<a name="l00580"></a>00580         $this-&gt;FontSize=$size/$this-&gt;k;
<a name="l00581"></a>00581         <span class="keywordflow">if</span>($this-&gt;page&gt;0)
<a name="l00582"></a>00582                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'BT /F%d %.2F Tf ET'</span>,$this-&gt;CurrentFont[<span class="charliteral">'i'</span>],$this-&gt;FontSizePt));
<a name="l00583"></a>00583 }
<a name="l00584"></a>00584 
<a name="l00585"></a><a class="code" href="class_f_p_d_f.html#a4784e97caa10d7b5bd5b37cdb8de523">00585</a> function <a class="code" href="class_f_p_d_f.html#a4784e97caa10d7b5bd5b37cdb8de523">AddLink</a>()
<a name="l00586"></a>00586 {
<a name="l00587"></a>00587         <span class="comment">//Create a new internal link</span>
<a name="l00588"></a>00588         <a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>=count($this-&gt;links)+1;
<a name="l00589"></a>00589         $this-&gt;links[<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>]=array(0, 0);
<a name="l00590"></a>00590         <span class="keywordflow">return</span> <a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>;
<a name="l00591"></a>00591 }
<a name="l00592"></a>00592 
<a name="l00593"></a><a class="code" href="class_f_p_d_f.html#b0137580cd5c01b4a48f4aec276706d4">00593</a> function <a class="code" href="class_f_p_d_f.html#b0137580cd5c01b4a48f4aec276706d4">SetLink</a>($link, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>=0, <a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">$page</a>=-1)
<a name="l00594"></a>00594 {
<a name="l00595"></a>00595         <span class="comment">//Set destination of internal link</span>
<a name="l00596"></a>00596         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>==-1)
<a name="l00597"></a>00597                 <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>=$this-&gt;y;
<a name="l00598"></a>00598         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">$page</a>==-1)
<a name="l00599"></a>00599                 <a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">$page</a>=$this-&gt;page;
<a name="l00600"></a>00600         $this-&gt;links[$link]=array(<a class="code" href="class_f_p_d_f.html#b36ea1d04d26856c68ed3021b56eec5b">$page</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>);
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00603"></a><a class="code" href="class_f_p_d_f.html#50de51eae9ed1dab3a448491fcbbdde5">00603</a> function <a class="code" href="class_f_p_d_f.html#50de51eae9ed1dab3a448491fcbbdde5">Link</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>, <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>, $link)
<a name="l00604"></a>00604 {
<a name="l00605"></a>00605         <span class="comment">//Put a link on the page</span>
<a name="l00606"></a>00606         $this-&gt;PageLinks[$this-&gt;page][]=array(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$this-&gt;k, $this-&gt;hPt-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>*$this-&gt;k, <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$this-&gt;k, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>*$this-&gt;k, $link);
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a><a class="code" href="class_f_p_d_f.html#f3354d9f93d576837fba5b157a1a7e37">00609</a> function <a class="code" href="class_f_p_d_f.html#f3354d9f93d576837fba5b157a1a7e37">Text</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>, $txt)
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611         <span class="comment">//Output a string</span>
<a name="l00612"></a>00612         $s=sprintf(<span class="stringliteral">'BT %.2F %.2F Td (%s) Tj ET'</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$this-&gt;k,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$this-&gt;k,$this-&gt;<a class="code" href="class_f_p_d_f.html#315a57aaf556052008dd99ff196b812e">_escape</a>($txt));
<a name="l00613"></a>00613         <span class="keywordflow">if</span>($this-&gt;underline &amp;&amp; $txt!=<span class="stringliteral">''</span>)
<a name="l00614"></a>00614                 $s.=<span class="charliteral">' '</span>.$this-&gt;_dounderline(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>,<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>,$txt);
<a name="l00615"></a>00615         <span class="keywordflow">if</span>($this-&gt;ColorFlag)
<a name="l00616"></a>00616                 $s=<span class="stringliteral">'q '</span>.$this-&gt;TextColor.<span class="charliteral">' '</span>.$s.<span class="stringliteral">' Q'</span>;
<a name="l00617"></a>00617         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($s);
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="class_f_p_d_f.html#cb406647f47041ae06ec01324e6a2377">00620</a> function <a class="code" href="class_f_p_d_f.html#cb406647f47041ae06ec01324e6a2377">AcceptPageBreak</a>()
<a name="l00621"></a>00621 {
<a name="l00622"></a>00622         <span class="comment">//Accept automatic page break or not</span>
<a name="l00623"></a>00623         <span class="keywordflow">return</span> $this-&gt;AutoPageBreak;
<a name="l00624"></a>00624 }
<a name="l00625"></a>00625 
<a name="l00626"></a><a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">00626</a> function <a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=0, $txt=<span class="stringliteral">''</span>, $border=0, $ln=0, $align=<span class="stringliteral">''</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">''</span>)
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628         <span class="comment">//Output a cell</span>
<a name="l00629"></a>00629         <a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>=$this-&gt;k;
<a name="l00630"></a>00630         <span class="keywordflow">if</span>($this-&gt;y+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>&gt;$this-&gt;PageBreakTrigger &amp;&amp; !$this-&gt;InHeader &amp;&amp; !$this-&gt;InFooter &amp;&amp; $this-&gt;<a class="code" href="class_f_p_d_f.html#cb406647f47041ae06ec01324e6a2377">AcceptPageBreak</a>())
<a name="l00631"></a>00631         {
<a name="l00632"></a>00632                 <span class="comment">//Automatic page break</span>
<a name="l00633"></a>00633                 <a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>=$this-&gt;x;
<a name="l00634"></a>00634                 <a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>=$this-&gt;ws;
<a name="l00635"></a>00635                 <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>&gt;0)
<a name="l00636"></a>00636                 {
<a name="l00637"></a>00637                         $this-&gt;ws=0;
<a name="l00638"></a>00638                         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(<span class="stringliteral">'0 Tw'</span>);
<a name="l00639"></a>00639                 }
<a name="l00640"></a>00640                 $this-&gt;<a class="code" href="class_f_p_d_f.html#24a18568a42d88b3db53f9cd46ef8694">AddPage</a>($this-&gt;CurOrientation,$this-&gt;CurPageFormat);
<a name="l00641"></a>00641                 $this-&gt;x=<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>;
<a name="l00642"></a>00642                 <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>&gt;0)
<a name="l00643"></a>00643                 {
<a name="l00644"></a>00644                         $this-&gt;ws=<a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>;
<a name="l00645"></a>00645                         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.3F Tw'</span>,<a class="code" href="class_f_p_d_f.html#05ee8f35c8f7e1d15680d28bb40eddf6">$ws</a>*<a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>));
<a name="l00646"></a>00646                 }
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>==0)
<a name="l00649"></a>00649                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00650"></a>00650         $s=<span class="stringliteral">''</span>;
<a name="l00651"></a>00651         <span class="keywordflow">if</span>($fill || $border==1)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653                 <span class="keywordflow">if</span>($fill)
<a name="l00654"></a>00654                         $op=($border==1) ? <span class="charliteral">'B'</span> : <span class="charliteral">'f'</span>;
<a name="l00655"></a>00655                 <span class="keywordflow">else</span>
<a name="l00656"></a>00656                         $op=<span class="charliteral">'S'</span>;
<a name="l00657"></a>00657                 $s=sprintf(<span class="stringliteral">'%.2F %.2F %.2F %.2F re %s '</span>,$this-&gt;x*<a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>,($this-&gt;h-$this-&gt;y)*$k,<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$k,-<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>*$k,$op);
<a name="l00658"></a>00658         }
<a name="l00659"></a>00659         <span class="keywordflow">if</span>(is_string($border))
<a name="l00660"></a>00660         {
<a name="l00661"></a>00661                 <a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>=$this-&gt;x;
<a name="l00662"></a>00662                 <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>=$this-&gt;y;
<a name="l00663"></a>00663                 <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'L'</span>)!==<span class="keyword">false</span>)
<a name="l00664"></a>00664                         $s.=sprintf(<span class="stringliteral">'%.2F %.2F m %.2F %.2F l S '</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*<a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$k,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>))*$k);
<a name="l00665"></a>00665                 <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'T'</span>)!==<span class="keyword">false</span>)
<a name="l00666"></a>00666                         $s.=sprintf(<span class="stringliteral">'%.2F %.2F m %.2F %.2F l S '</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$k,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$k,(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>+<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>)*$k,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$k);
<a name="l00667"></a>00667                 <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'R'</span>)!==<span class="keyword">false</span>)
<a name="l00668"></a>00668                         $s.=sprintf(<span class="stringliteral">'%.2F %.2F m %.2F %.2F l S '</span>,(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>+<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>)*$k,($this-&gt;h-<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)*$k,(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>+<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>)*$k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>))*$k);
<a name="l00669"></a>00669                 <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'B'</span>)!==<span class="keyword">false</span>)
<a name="l00670"></a>00670                         $s.=sprintf(<span class="stringliteral">'%.2F %.2F m %.2F %.2F l S '</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>))*$k,(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>+<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>)*$k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>))*$k);
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672         <span class="keywordflow">if</span>($txt!==<span class="stringliteral">''</span>)
<a name="l00673"></a>00673         {
<a name="l00674"></a>00674                 <span class="keywordflow">if</span>($align==<span class="charliteral">'R'</span>)
<a name="l00675"></a>00675                         $dx=<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-$this-&gt;cMargin-$this-&gt;<a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">GetStringWidth</a>($txt);
<a name="l00676"></a>00676                 elseif($align==<span class="charliteral">'C'</span>)
<a name="l00677"></a>00677                         $dx=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-$this-&gt;<a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">GetStringWidth</a>($txt))/2;
<a name="l00678"></a>00678                 <span class="keywordflow">else</span>
<a name="l00679"></a>00679                         $dx=$this-&gt;cMargin;
<a name="l00680"></a>00680                 <span class="keywordflow">if</span>($this-&gt;ColorFlag)
<a name="l00681"></a>00681                         $s.=<span class="stringliteral">'q '</span>.$this-&gt;TextColor.<span class="charliteral">' '</span>;
<a name="l00682"></a>00682                 $txt2=str_replace(<span class="charliteral">')'</span>,<span class="stringliteral">'\\)'</span>,str_replace(<span class="charliteral">'('</span>,<span class="stringliteral">'\\('</span>,str_replace(<span class="charliteral">'\\'</span>,<span class="stringliteral">'\\\\'</span>,$txt)));
<a name="l00683"></a>00683                 $s.=sprintf(<span class="stringliteral">'BT %.2F %.2F Td (%s) Tj ET'</span>,($this-&gt;x+$dx)*<a class="code" href="class_f_p_d_f.html#dadc589358125e9865dc6565722b7a08">$k</a>,($this-&gt;h-($this-&gt;y+.5*<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>+.3*$this-&gt;FontSize))*$k,$txt2);
<a name="l00684"></a>00684                 <span class="keywordflow">if</span>($this-&gt;underline)
<a name="l00685"></a>00685                         $s.=<span class="charliteral">' '</span>.$this-&gt;_dounderline($this-&gt;x+$dx,$this-&gt;y+.5*<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>+.3*$this-&gt;FontSize,$txt);
<a name="l00686"></a>00686                 <span class="keywordflow">if</span>($this-&gt;ColorFlag)
<a name="l00687"></a>00687                         $s.=<span class="stringliteral">' Q'</span>;
<a name="l00688"></a>00688                 <span class="keywordflow">if</span>($link)
<a name="l00689"></a>00689                         $this-&gt;<a class="code" href="class_f_p_d_f.html#50de51eae9ed1dab3a448491fcbbdde5">Link</a>($this-&gt;x+$dx,$this-&gt;y+.5*<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>-.5*$this-&gt;FontSize,$this-&gt;<a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">GetStringWidth</a>($txt),$this-&gt;FontSize,$link);
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691         <span class="keywordflow">if</span>($s)
<a name="l00692"></a>00692                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>($s);
<a name="l00693"></a>00693         $this-&gt;lasth=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;
<a name="l00694"></a>00694         <span class="keywordflow">if</span>($ln&gt;0)
<a name="l00695"></a>00695         {
<a name="l00696"></a>00696                 <span class="comment">//Go to next line</span>
<a name="l00697"></a>00697                 $this-&gt;y+=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;
<a name="l00698"></a>00698                 <span class="keywordflow">if</span>($ln==1)
<a name="l00699"></a>00699                         $this-&gt;x=$this-&gt;lMargin;
<a name="l00700"></a>00700         }
<a name="l00701"></a>00701         <span class="keywordflow">else</span>
<a name="l00702"></a>00702                 $this-&gt;x+=<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>;
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a><a class="code" href="class_f_p_d_f.html#aa047bd8692257bb2962d5d65c090319">00705</a> function <a class="code" href="class_f_p_d_f.html#aa047bd8692257bb2962d5d65c090319">MultiCell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>, $txt, $border=0, $align=<span class="charliteral">'J'</span>, $fill=<span class="keyword">false</span>)
<a name="l00706"></a>00706 {
<a name="l00707"></a>00707         <span class="comment">//Output text with automatic or explicit line breaks</span>
<a name="l00708"></a>00708         $cw=&amp;$this-&gt;CurrentFont[<span class="stringliteral">'cw'</span>];
<a name="l00709"></a>00709         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>==0)
<a name="l00710"></a>00710                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00711"></a>00711         $wmax=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-2*$this-&gt;cMargin)*1000/$this-&gt;FontSize;
<a name="l00712"></a>00712         $s=str_replace(<span class="stringliteral">"\r"</span>,<span class="stringliteral">''</span>,$txt);
<a name="l00713"></a>00713         $nb=strlen($s);
<a name="l00714"></a>00714         <span class="keywordflow">if</span>($nb&gt;0 &amp;&amp; $s[$nb-1]==<span class="stringliteral">"\n"</span>)
<a name="l00715"></a>00715                 $nb--;
<a name="l00716"></a>00716         $b=0;
<a name="l00717"></a>00717         <span class="keywordflow">if</span>($border)
<a name="l00718"></a>00718         {
<a name="l00719"></a>00719                 <span class="keywordflow">if</span>($border==1)
<a name="l00720"></a>00720                 {
<a name="l00721"></a>00721                         $border=<span class="stringliteral">'LTRB'</span>;
<a name="l00722"></a>00722                         $b=<span class="stringliteral">'LRT'</span>;
<a name="l00723"></a>00723                         $b2=<span class="stringliteral">'LR'</span>;
<a name="l00724"></a>00724                 }
<a name="l00725"></a>00725                 <span class="keywordflow">else</span>
<a name="l00726"></a>00726                 {
<a name="l00727"></a>00727                         $b2=<span class="stringliteral">''</span>;
<a name="l00728"></a>00728                         <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'L'</span>)!==<span class="keyword">false</span>)
<a name="l00729"></a>00729                                 $b2.=<span class="charliteral">'L'</span>;
<a name="l00730"></a>00730                         <span class="keywordflow">if</span>(strpos($border,<span class="charliteral">'R'</span>)!==<span class="keyword">false</span>)
<a name="l00731"></a>00731                                 $b2.=<span class="charliteral">'R'</span>;
<a name="l00732"></a>00732                         $b=(strpos($border,<span class="charliteral">'T'</span>)!==<span class="keyword">false</span>) ? $b2.<span class="charliteral">'T'</span> : $b2;
<a name="l00733"></a>00733                 }
<a name="l00734"></a>00734         }
<a name="l00735"></a>00735         $sep=-1;
<a name="l00736"></a>00736         $i=0;
<a name="l00737"></a>00737         $j=0;
<a name="l00738"></a>00738         $l=0;
<a name="l00739"></a>00739         $ns=0;
<a name="l00740"></a>00740         $nl=1;
<a name="l00741"></a>00741         <span class="keywordflow">while</span>($i&lt;$nb)
<a name="l00742"></a>00742         {
<a name="l00743"></a>00743                 <span class="comment">//Get next character</span>
<a name="l00744"></a>00744                 $c=$s[$i];
<a name="l00745"></a>00745                 <span class="keywordflow">if</span>($c==<span class="stringliteral">"\n"</span>)
<a name="l00746"></a>00746                 {
<a name="l00747"></a>00747                         <span class="comment">//Explicit line break</span>
<a name="l00748"></a>00748                         <span class="keywordflow">if</span>($this-&gt;ws&gt;0)
<a name="l00749"></a>00749                         {
<a name="l00750"></a>00750                                 $this-&gt;ws=0;
<a name="l00751"></a>00751                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(<span class="stringliteral">'0 Tw'</span>);
<a name="l00752"></a>00752                         }
<a name="l00753"></a>00753                         $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$i-$j),$b,2,$align,$fill);
<a name="l00754"></a>00754                         $i++;
<a name="l00755"></a>00755                         $sep=-1;
<a name="l00756"></a>00756                         $j=$i;
<a name="l00757"></a>00757                         $l=0;
<a name="l00758"></a>00758                         $ns=0;
<a name="l00759"></a>00759                         $nl++;
<a name="l00760"></a>00760                         <span class="keywordflow">if</span>($border &amp;&amp; $nl==2)
<a name="l00761"></a>00761                                 $b=$b2;
<a name="l00762"></a>00762                         <span class="keywordflow">continue</span>;
<a name="l00763"></a>00763                 }
<a name="l00764"></a>00764                 <span class="keywordflow">if</span>($c==<span class="charliteral">' '</span>)
<a name="l00765"></a>00765                 {
<a name="l00766"></a>00766                         $sep=$i;
<a name="l00767"></a>00767                         $ls=$l;
<a name="l00768"></a>00768                         $ns++;
<a name="l00769"></a>00769                 }
<a name="l00770"></a>00770                 $l+=$cw[$c];
<a name="l00771"></a>00771                 <span class="keywordflow">if</span>($l&gt;$wmax)
<a name="l00772"></a>00772                 {
<a name="l00773"></a>00773                         <span class="comment">//Automatic line break</span>
<a name="l00774"></a>00774                         <span class="keywordflow">if</span>($sep==-1)
<a name="l00775"></a>00775                         {
<a name="l00776"></a>00776                                 <span class="keywordflow">if</span>($i==$j)
<a name="l00777"></a>00777                                         $i++;
<a name="l00778"></a>00778                                 <span class="keywordflow">if</span>($this-&gt;ws&gt;0)
<a name="l00779"></a>00779                                 {
<a name="l00780"></a>00780                                         $this-&gt;ws=0;
<a name="l00781"></a>00781                                         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(<span class="stringliteral">'0 Tw'</span>);
<a name="l00782"></a>00782                                 }
<a name="l00783"></a>00783                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$i-$j),$b,2,$align,$fill);
<a name="l00784"></a>00784                         }
<a name="l00785"></a>00785                         <span class="keywordflow">else</span>
<a name="l00786"></a>00786                         {
<a name="l00787"></a>00787                                 <span class="keywordflow">if</span>($align==<span class="charliteral">'J'</span>)
<a name="l00788"></a>00788                                 {
<a name="l00789"></a>00789                                         $this-&gt;ws=($ns&gt;1) ? ($wmax-$ls)/1000*$this-&gt;FontSize/($ns-1) : 0;
<a name="l00790"></a>00790                                         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'%.3F Tw'</span>,$this-&gt;ws*$this-&gt;k));
<a name="l00791"></a>00791                                 }
<a name="l00792"></a>00792                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$sep-$j),$b,2,$align,$fill);
<a name="l00793"></a>00793                                 $i=$sep+1;
<a name="l00794"></a>00794                         }
<a name="l00795"></a>00795                         $sep=-1;
<a name="l00796"></a>00796                         $j=$i;
<a name="l00797"></a>00797                         $l=0;
<a name="l00798"></a>00798                         $ns=0;
<a name="l00799"></a>00799                         $nl++;
<a name="l00800"></a>00800                         <span class="keywordflow">if</span>($border &amp;&amp; $nl==2)
<a name="l00801"></a>00801                                 $b=$b2;
<a name="l00802"></a>00802                 }
<a name="l00803"></a>00803                 <span class="keywordflow">else</span>
<a name="l00804"></a>00804                         $i++;
<a name="l00805"></a>00805         }
<a name="l00806"></a>00806         <span class="comment">//Last chunk</span>
<a name="l00807"></a>00807         <span class="keywordflow">if</span>($this-&gt;ws&gt;0)
<a name="l00808"></a>00808         {
<a name="l00809"></a>00809                 $this-&gt;ws=0;
<a name="l00810"></a>00810                 $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(<span class="stringliteral">'0 Tw'</span>);
<a name="l00811"></a>00811         }
<a name="l00812"></a>00812         <span class="keywordflow">if</span>($border &amp;&amp; strpos($border,<span class="charliteral">'B'</span>)!==<span class="keyword">false</span>)
<a name="l00813"></a>00813                 $b.=<span class="charliteral">'B'</span>;
<a name="l00814"></a>00814         $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$i-$j),$b,2,$align,$fill);
<a name="l00815"></a>00815         $this-&gt;x=$this-&gt;lMargin;
<a name="l00816"></a>00816 }
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="class_f_p_d_f.html#75beddaabec9e3d2b8939bd46f99e615">00818</a> function <a class="code" href="class_f_p_d_f.html#75beddaabec9e3d2b8939bd46f99e615">Write</a>(<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>, $txt, $link=<span class="stringliteral">''</span>)
<a name="l00819"></a>00819 {
<a name="l00820"></a>00820         <span class="comment">//Output text in flowing mode</span>
<a name="l00821"></a>00821         $cw=&amp;$this-&gt;CurrentFont[<span class="stringliteral">'cw'</span>];
<a name="l00822"></a>00822         <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00823"></a>00823         $wmax=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-2*$this-&gt;cMargin)*1000/$this-&gt;FontSize;
<a name="l00824"></a>00824         $s=str_replace(<span class="stringliteral">"\r"</span>,<span class="stringliteral">''</span>,$txt);
<a name="l00825"></a>00825         $nb=strlen($s);
<a name="l00826"></a>00826         $sep=-1;
<a name="l00827"></a>00827         $i=0;
<a name="l00828"></a>00828         $j=0;
<a name="l00829"></a>00829         $l=0;
<a name="l00830"></a>00830         $nl=1;
<a name="l00831"></a>00831         <span class="keywordflow">while</span>($i&lt;$nb)
<a name="l00832"></a>00832         {
<a name="l00833"></a>00833                 <span class="comment">//Get next character</span>
<a name="l00834"></a>00834                 $c=$s[$i];
<a name="l00835"></a>00835                 <span class="keywordflow">if</span>($c==<span class="stringliteral">"\n"</span>)
<a name="l00836"></a>00836                 {
<a name="l00837"></a>00837                         <span class="comment">//Explicit line break</span>
<a name="l00838"></a>00838                         $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$i-$j),0,2,<span class="stringliteral">''</span>,0,$link);
<a name="l00839"></a>00839                         $i++;
<a name="l00840"></a>00840                         $sep=-1;
<a name="l00841"></a>00841                         $j=$i;
<a name="l00842"></a>00842                         $l=0;
<a name="l00843"></a>00843                         <span class="keywordflow">if</span>($nl==1)
<a name="l00844"></a>00844                         {
<a name="l00845"></a>00845                                 $this-&gt;x=$this-&gt;lMargin;
<a name="l00846"></a>00846                                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00847"></a>00847                                 $wmax=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-2*$this-&gt;cMargin)*1000/$this-&gt;FontSize;
<a name="l00848"></a>00848                         }
<a name="l00849"></a>00849                         $nl++;
<a name="l00850"></a>00850                         <span class="keywordflow">continue</span>;
<a name="l00851"></a>00851                 }
<a name="l00852"></a>00852                 <span class="keywordflow">if</span>($c==<span class="charliteral">' '</span>)
<a name="l00853"></a>00853                         $sep=$i;
<a name="l00854"></a>00854                 $l+=$cw[$c];
<a name="l00855"></a>00855                 <span class="keywordflow">if</span>($l&gt;$wmax)
<a name="l00856"></a>00856                 {
<a name="l00857"></a>00857                         <span class="comment">//Automatic line break</span>
<a name="l00858"></a>00858                         <span class="keywordflow">if</span>($sep==-1)
<a name="l00859"></a>00859                         {
<a name="l00860"></a>00860                                 <span class="keywordflow">if</span>($this-&gt;x&gt;$this-&gt;lMargin)
<a name="l00861"></a>00861                                 {
<a name="l00862"></a>00862                                         <span class="comment">//Move to next line</span>
<a name="l00863"></a>00863                                         $this-&gt;x=$this-&gt;lMargin;
<a name="l00864"></a>00864                                         $this-&gt;y+=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;
<a name="l00865"></a>00865                                         <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00866"></a>00866                                         $wmax=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-2*$this-&gt;cMargin)*1000/$this-&gt;FontSize;
<a name="l00867"></a>00867                                         $i++;
<a name="l00868"></a>00868                                         $nl++;
<a name="l00869"></a>00869                                         <span class="keywordflow">continue</span>;
<a name="l00870"></a>00870                                 }
<a name="l00871"></a>00871                                 <span class="keywordflow">if</span>($i==$j)
<a name="l00872"></a>00872                                         $i++;
<a name="l00873"></a>00873                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$i-$j),0,2,<span class="stringliteral">''</span>,0,$link);
<a name="l00874"></a>00874                         }
<a name="l00875"></a>00875                         <span class="keywordflow">else</span>
<a name="l00876"></a>00876                         {
<a name="l00877"></a>00877                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j,$sep-$j),0,2,<span class="stringliteral">''</span>,0,$link);
<a name="l00878"></a>00878                                 $i=$sep+1;
<a name="l00879"></a>00879                         }
<a name="l00880"></a>00880                         $sep=-1;
<a name="l00881"></a>00881                         $j=$i;
<a name="l00882"></a>00882                         $l=0;
<a name="l00883"></a>00883                         <span class="keywordflow">if</span>($nl==1)
<a name="l00884"></a>00884                         {
<a name="l00885"></a>00885                                 $this-&gt;x=$this-&gt;lMargin;
<a name="l00886"></a>00886                                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;w-$this-&gt;rMargin-$this-&gt;x;
<a name="l00887"></a>00887                                 $wmax=(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>-2*$this-&gt;cMargin)*1000/$this-&gt;FontSize;
<a name="l00888"></a>00888                         }
<a name="l00889"></a>00889                         $nl++;
<a name="l00890"></a>00890                 }
<a name="l00891"></a>00891                 <span class="keywordflow">else</span>
<a name="l00892"></a>00892                         $i++;
<a name="l00893"></a>00893         }
<a name="l00894"></a>00894         <span class="comment">//Last chunk</span>
<a name="l00895"></a>00895         <span class="keywordflow">if</span>($i!=$j)
<a name="l00896"></a>00896                 $this-&gt;<a class="code" href="class_f_p_d_f.html#37c88a6a7daf937b3dd88a903ccbfa64">Cell</a>($l/1000*$this-&gt;FontSize,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,substr($s,$j),0,0,<span class="stringliteral">''</span>,0,$link);
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a><a class="code" href="class_f_p_d_f.html#445e0364c7fa330c415495bb31f5651c">00899</a> function <a class="code" href="class_f_p_d_f.html#445e0364c7fa330c415495bb31f5651c">Ln</a>(<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=null)
<a name="l00900"></a>00900 {
<a name="l00901"></a>00901         <span class="comment">//Line feed; default value is last cell height</span>
<a name="l00902"></a>00902         $this-&gt;x=$this-&gt;lMargin;
<a name="l00903"></a>00903         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>===null)
<a name="l00904"></a>00904                 $this-&gt;y+=$this-&gt;lasth;
<a name="l00905"></a>00905         <span class="keywordflow">else</span>
<a name="l00906"></a>00906                 $this-&gt;y+=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="class_f_p_d_f.html#680c80cc244b5636db22994cf1b27a68">00909</a> function <a class="code" href="class_f_p_d_f.html#680c80cc244b5636db22994cf1b27a68">Image</a>($file, <a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>=null, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>=null, <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=0, <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=0, $type=<span class="stringliteral">''</span>, $link=<span class="stringliteral">''</span>)
<a name="l00910"></a>00910 {
<a name="l00911"></a>00911         <span class="comment">//Put an image on the page</span>
<a name="l00912"></a>00912         <span class="keywordflow">if</span>(!isset($this-&gt;images[$file]))
<a name="l00913"></a>00913         {
<a name="l00914"></a>00914                 <span class="comment">//First use of this image, get info</span>
<a name="l00915"></a>00915                 <span class="keywordflow">if</span>($type==<span class="stringliteral">''</span>)
<a name="l00916"></a>00916                 {
<a name="l00917"></a>00917                         $pos=strrpos($file,<span class="charliteral">'.'</span>);
<a name="l00918"></a>00918                         <span class="keywordflow">if</span>(!$pos)
<a name="l00919"></a>00919                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Image file has no extension and no type was specified: '</span>.$file);
<a name="l00920"></a>00920                         $type=substr($file,$pos+1);
<a name="l00921"></a>00921                 }
<a name="l00922"></a>00922                 $type=strtolower($type);
<a name="l00923"></a>00923                 <span class="keywordflow">if</span>($type==<span class="stringliteral">'jpeg'</span>)
<a name="l00924"></a>00924                         $type=<span class="stringliteral">'jpg'</span>;
<a name="l00925"></a>00925                 $mtd=<span class="stringliteral">'_parse'</span>.$type;
<a name="l00926"></a>00926                 <span class="keywordflow">if</span>(!method_exists($this,$mtd))
<a name="l00927"></a>00927                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Unsupported image type: '</span>.$type);
<a name="l00928"></a>00928                 $info=$this-&gt;$mtd($file);
<a name="l00929"></a>00929                 $info[<span class="charliteral">'i'</span>]=count($this-&gt;images)+1;
<a name="l00930"></a>00930                 $this-&gt;images[$file]=$info;
<a name="l00931"></a>00931         }
<a name="l00932"></a>00932         <span class="keywordflow">else</span>
<a name="l00933"></a>00933                 $info=$this-&gt;images[$file];
<a name="l00934"></a>00934         <span class="comment">//Automatic width and height calculation if needed</span>
<a name="l00935"></a>00935         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>==0 &amp;&amp; <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>==0)
<a name="l00936"></a>00936         {
<a name="l00937"></a>00937                 <span class="comment">//Put image at 72 dpi</span>
<a name="l00938"></a>00938                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$info[<span class="charliteral">'w'</span>]/$this-&gt;k;
<a name="l00939"></a>00939                 <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=$info[<span class="charliteral">'h'</span>]/$this-&gt;k;
<a name="l00940"></a>00940         }
<a name="l00941"></a>00941         elseif(<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>==0)
<a name="l00942"></a>00942                 <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>*$info[<span class="charliteral">'w'</span>]/$info[<span class="charliteral">'h'</span>];
<a name="l00943"></a>00943         elseif(<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>==0)
<a name="l00944"></a>00944                 <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$info[<span class="charliteral">'h'</span>]/$info[<span class="charliteral">'w'</span>];
<a name="l00945"></a>00945         <span class="comment">//Flowing mode</span>
<a name="l00946"></a>00946         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>===null)
<a name="l00947"></a>00947         {
<a name="l00948"></a>00948                 <span class="keywordflow">if</span>($this-&gt;y+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>&gt;$this-&gt;PageBreakTrigger &amp;&amp; !$this-&gt;InHeader &amp;&amp; !$this-&gt;InFooter &amp;&amp; $this-&gt;<a class="code" href="class_f_p_d_f.html#cb406647f47041ae06ec01324e6a2377">AcceptPageBreak</a>())
<a name="l00949"></a>00949                 {
<a name="l00950"></a>00950                         <span class="comment">//Automatic page break</span>
<a name="l00951"></a>00951                         $x2=$this-&gt;x;
<a name="l00952"></a>00952                         $this-&gt;<a class="code" href="class_f_p_d_f.html#24a18568a42d88b3db53f9cd46ef8694">AddPage</a>($this-&gt;CurOrientation,$this-&gt;CurPageFormat);
<a name="l00953"></a>00953                         $this-&gt;x=$x2;
<a name="l00954"></a>00954                 }
<a name="l00955"></a>00955                 <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>=$this-&gt;y;
<a name="l00956"></a>00956                 $this-&gt;y+=<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>;
<a name="l00957"></a>00957         }
<a name="l00958"></a>00958         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>===null)
<a name="l00959"></a>00959                 <a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>=$this-&gt;x;
<a name="l00960"></a>00960         $this-&gt;<a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">_out</a>(sprintf(<span class="stringliteral">'q %.2F 0 0 %.2F %.2F %.2F cm /I%d Do Q'</span>,<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$this-&gt;k,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>*$this-&gt;k,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$this-&gt;k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>+<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>))*$this-&gt;k,$info[<span class="charliteral">'i'</span>]));
<a name="l00961"></a>00961         <span class="keywordflow">if</span>($link)
<a name="l00962"></a>00962                 $this-&gt;<a class="code" href="class_f_p_d_f.html#50de51eae9ed1dab3a448491fcbbdde5">Link</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>,<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>,<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>,<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>,$link);
<a name="l00963"></a>00963 }
<a name="l00964"></a>00964 
<a name="l00965"></a><a class="code" href="class_f_p_d_f.html#8b7bbc6309142f76ec2a78815f2f700f">00965</a> function <a class="code" href="class_f_p_d_f.html#8b7bbc6309142f76ec2a78815f2f700f">GetX</a>()
<a name="l00966"></a>00966 {
<a name="l00967"></a>00967         <span class="comment">//Get x position</span>
<a name="l00968"></a>00968         <span class="keywordflow">return</span> $this-&gt;x;
<a name="l00969"></a>00969 }
<a name="l00970"></a>00970 
<a name="l00971"></a><a class="code" href="class_f_p_d_f.html#2bfd055c0ed78a7929fa17ba64f9cf65">00971</a> function <a class="code" href="class_f_p_d_f.html#2bfd055c0ed78a7929fa17ba64f9cf65">SetX</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>)
<a name="l00972"></a>00972 {
<a name="l00973"></a>00973         <span class="comment">//Set x position</span>
<a name="l00974"></a>00974         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>&gt;=0)
<a name="l00975"></a>00975                 $this-&gt;x=<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>;
<a name="l00976"></a>00976         <span class="keywordflow">else</span>
<a name="l00977"></a>00977                 $this-&gt;x=$this-&gt;w+<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>;
<a name="l00978"></a>00978 }
<a name="l00979"></a>00979 
<a name="l00980"></a><a class="code" href="class_f_p_d_f.html#7a0b514eaa73283268ac14e9f0d7f0c4">00980</a> function <a class="code" href="class_f_p_d_f.html#7a0b514eaa73283268ac14e9f0d7f0c4">GetY</a>()
<a name="l00981"></a>00981 {
<a name="l00982"></a>00982         <span class="comment">//Get y position</span>
<a name="l00983"></a>00983         <span class="keywordflow">return</span> $this-&gt;y;
<a name="l00984"></a>00984 }
<a name="l00985"></a>00985 
<a name="l00986"></a><a class="code" href="class_f_p_d_f.html#7a0e004fce75cd2cd3501cf54be632e4">00986</a> function <a class="code" href="class_f_p_d_f.html#7a0e004fce75cd2cd3501cf54be632e4">SetY</a>(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)
<a name="l00987"></a>00987 {
<a name="l00988"></a>00988         <span class="comment">//Set y position and reset x</span>
<a name="l00989"></a>00989         $this-&gt;x=$this-&gt;lMargin;
<a name="l00990"></a>00990         <span class="keywordflow">if</span>(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>&gt;=0)
<a name="l00991"></a>00991                 $this-&gt;y=<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>;
<a name="l00992"></a>00992         <span class="keywordflow">else</span>
<a name="l00993"></a>00993                 $this-&gt;y=$this-&gt;h+<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>;
<a name="l00994"></a>00994 }
<a name="l00995"></a>00995 
<a name="l00996"></a><a class="code" href="class_f_p_d_f.html#2c191daee30b7ea3a66696bd0be92a3e">00996</a> function <a class="code" href="class_f_p_d_f.html#2c191daee30b7ea3a66696bd0be92a3e">SetXY</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>)
<a name="l00997"></a>00997 {
<a name="l00998"></a>00998         <span class="comment">//Set x and y positions</span>
<a name="l00999"></a>00999         $this-&gt;<a class="code" href="class_f_p_d_f.html#7a0e004fce75cd2cd3501cf54be632e4">SetY</a>(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>);
<a name="l01000"></a>01000         $this-&gt;<a class="code" href="class_f_p_d_f.html#2bfd055c0ed78a7929fa17ba64f9cf65">SetX</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>);
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01003"></a><a class="code" href="class_f_p_d_f.html#c4e0bfb71d9e602637c67016e4b5dd40">01003</a> function <a class="code" href="class_f_p_d_f.html#c4e0bfb71d9e602637c67016e4b5dd40">Output</a>($name=<span class="stringliteral">''</span>, $dest=<span class="stringliteral">''</span>)
<a name="l01004"></a>01004 {
<a name="l01005"></a>01005         <span class="comment">//Output PDF to some destination</span>
<a name="l01006"></a>01006         <span class="keywordflow">if</span>($this-&gt;state&lt;3)
<a name="l01007"></a>01007                 $this-&gt;<a class="code" href="class_f_p_d_f.html#f6bcdd2acb114191b61065e85ff0b62c">Close</a>();
<a name="l01008"></a>01008         $dest=strtoupper($dest);
<a name="l01009"></a>01009         <span class="keywordflow">if</span>($dest==<span class="stringliteral">''</span>)
<a name="l01010"></a>01010         {
<a name="l01011"></a>01011                 <span class="keywordflow">if</span>($name==<span class="stringliteral">''</span>)
<a name="l01012"></a>01012                 {
<a name="l01013"></a>01013                         $name=<span class="stringliteral">'doc.pdf'</span>;
<a name="l01014"></a>01014                         $dest=<span class="charliteral">'I'</span>;
<a name="l01015"></a>01015                 }
<a name="l01016"></a>01016                 <span class="keywordflow">else</span>
<a name="l01017"></a>01017                         $dest=<span class="charliteral">'F'</span>;
<a name="l01018"></a>01018         }
<a name="l01019"></a>01019         <span class="keywordflow">switch</span>($dest)
<a name="l01020"></a>01020         {
<a name="l01021"></a>01021                 <span class="keywordflow">case</span> <span class="charliteral">'I'</span>:
<a name="l01022"></a>01022                         <span class="comment">//Send to standard output</span>
<a name="l01023"></a>01023                         <span class="keywordflow">if</span>(ob_get_length())
<a name="l01024"></a>01024                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Some data has already been output, can\'t send PDF file'</span>);
<a name="l01025"></a>01025                         <span class="keywordflow">if</span>(php_sapi_name()!=<span class="stringliteral">'cli'</span>)
<a name="l01026"></a>01026                         {
<a name="l01027"></a>01027                                 <span class="comment">//We send to a browser</span>
<a name="l01028"></a>01028                                 header(<span class="stringliteral">'Content-Type: application/pdf'</span>);
<a name="l01029"></a>01029                                 <span class="keywordflow">if</span>(headers_sent())
<a name="l01030"></a>01030                                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Some data has already been output, can\'t send PDF file'</span>);
<a name="l01031"></a>01031                                 header(<span class="stringliteral">'Content-Length: '</span>.strlen($this-&gt;buffer));
<a name="l01032"></a>01032                                 header(<span class="stringliteral">'Content-Disposition: inline; filename="'</span>.$name.<span class="charliteral">'"'</span>);
<a name="l01033"></a>01033                                 header(<span class="stringliteral">'Cache-Control: private, max-age=0, must-revalidate'</span>);
<a name="l01034"></a>01034                                 header(<span class="stringliteral">'Pragma: public'</span>);
<a name="l01035"></a>01035                                 ini_set(<span class="stringliteral">'zlib.output_compression'</span>,<span class="charliteral">'0'</span>);
<a name="l01036"></a>01036                         }
<a name="l01037"></a>01037                         echo $this-&gt;buffer;
<a name="l01038"></a>01038                         <span class="keywordflow">break</span>;
<a name="l01039"></a>01039                 <span class="keywordflow">case</span> <span class="charliteral">'D'</span>:
<a name="l01040"></a>01040                         <span class="comment">//Download file</span>
<a name="l01041"></a>01041                         <span class="keywordflow">if</span>(ob_get_length())
<a name="l01042"></a>01042                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Some data has already been output, can\'t send PDF file'</span>);
<a name="l01043"></a>01043                         header(<span class="stringliteral">'Content-Type: application/x-download'</span>);
<a name="l01044"></a>01044                         <span class="keywordflow">if</span>(headers_sent())
<a name="l01045"></a>01045                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Some data has already been output, can\'t send PDF file'</span>);
<a name="l01046"></a>01046                         header(<span class="stringliteral">'Content-Length: '</span>.strlen($this-&gt;buffer));
<a name="l01047"></a>01047                         header(<span class="stringliteral">'Content-Disposition: attachment; filename="'</span>.$name.<span class="charliteral">'"'</span>);
<a name="l01048"></a>01048                         header(<span class="stringliteral">'Cache-Control: private, max-age=0, must-revalidate'</span>);
<a name="l01049"></a>01049                         header(<span class="stringliteral">'Pragma: public'</span>);
<a name="l01050"></a>01050                         ini_set(<span class="stringliteral">'zlib.output_compression'</span>,<span class="charliteral">'0'</span>);
<a name="l01051"></a>01051                         echo $this-&gt;buffer;
<a name="l01052"></a>01052                         <span class="keywordflow">break</span>;
<a name="l01053"></a>01053                 <span class="keywordflow">case</span> <span class="charliteral">'F'</span>:
<a name="l01054"></a>01054                         <span class="comment">//Save to local file</span>
<a name="l01055"></a>01055                         $f=fopen($name,<span class="stringliteral">'wb'</span>);
<a name="l01056"></a>01056                         <span class="keywordflow">if</span>(!$f)
<a name="l01057"></a>01057                                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Unable to create output file: '</span>.$name);
<a name="l01058"></a>01058                         fwrite($f,$this-&gt;buffer,strlen($this-&gt;buffer));
<a name="l01059"></a>01059                         fclose($f);
<a name="l01060"></a>01060                         <span class="keywordflow">break</span>;
<a name="l01061"></a>01061                 <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
<a name="l01062"></a>01062                         <span class="comment">//Return as a string</span>
<a name="l01063"></a>01063                         <span class="keywordflow">return</span> $this-&gt;buffer;
<a name="l01064"></a>01064                 <span class="keywordflow">default</span>:
<a name="l01065"></a>01065                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect output destination: '</span>.$dest);
<a name="l01066"></a>01066         }
<a name="l01067"></a>01067         <span class="keywordflow">return</span> <span class="stringliteral">''</span>;
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">/*******************************************************************************</span>
<a name="l01071"></a>01071 <span class="comment">*                                                                              *</span>
<a name="l01072"></a>01072 <span class="comment">*                              Protected methods                               *</span>
<a name="l01073"></a>01073 <span class="comment">*                                                                              *</span>
<a name="l01074"></a>01074 <span class="comment">*******************************************************************************/</span>
<a name="l01075"></a><a class="code" href="class_f_p_d_f.html#1ce404a00709a07ca9851b91aefbb0c4">01075</a> function <a class="code" href="class_f_p_d_f.html#1ce404a00709a07ca9851b91aefbb0c4">_dochecks</a>()
<a name="l01076"></a>01076 {
<a name="l01077"></a>01077         <span class="comment">//Check availability of %F</span>
<a name="l01078"></a>01078         <span class="keywordflow">if</span>(sprintf(<span class="stringliteral">'%.1F'</span>,1.0)!=<span class="stringliteral">'1.0'</span>)
<a name="l01079"></a>01079                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'This version of PHP is not supported'</span>);
<a name="l01080"></a>01080         <span class="comment">//Check mbstring overloading</span>
<a name="l01081"></a>01081         <span class="keywordflow">if</span>(ini_get(<span class="stringliteral">'mbstring.func_overload'</span>) &amp; 2)
<a name="l01082"></a>01082                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'mbstring overloading must be disabled'</span>);
<a name="l01083"></a>01083         <span class="comment">//Disable runtime magic quotes</span>
<a name="l01084"></a>01084         <span class="keywordflow">if</span>(get_magic_quotes_runtime())
<a name="l01085"></a>01085                 @set_magic_quotes_runtime(0);
<a name="l01086"></a>01086 }
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="class_f_p_d_f.html#12b4afff54d10102c052ec8618713df4">01088</a> function <a class="code" href="class_f_p_d_f.html#12b4afff54d10102c052ec8618713df4">_getpageformat</a>($format)
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090         $format=strtolower($format);
<a name="l01091"></a>01091         <span class="keywordflow">if</span>(!isset($this-&gt;PageFormats[$format]))
<a name="l01092"></a>01092                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Unknown page format: '</span>.$format);
<a name="l01093"></a>01093         $a=$this-&gt;PageFormats[$format];
<a name="l01094"></a>01094         <span class="keywordflow">return</span> array($a[0]/$this-&gt;k, $a[1]/$this-&gt;k);
<a name="l01095"></a>01095 }
<a name="l01096"></a>01096 
<a name="l01097"></a><a class="code" href="class_f_p_d_f.html#85f08b8bb203ef7d3759f5d1cbd83f82">01097</a> function <a class="code" href="class_f_p_d_f.html#85f08b8bb203ef7d3759f5d1cbd83f82">_getfontpath</a>()
<a name="l01098"></a>01098 {
<a name="l01099"></a>01099         <span class="keywordflow">if</span>(!defined(<span class="stringliteral">'FPDF_FONTPATH'</span>) &amp;&amp; is_dir(dirname(__FILE__).<span class="stringliteral">'/font'</span>))
<a name="l01100"></a>01100                 define(<span class="stringliteral">'FPDF_FONTPATH'</span>,dirname(__FILE__).<span class="stringliteral">'/font/'</span>);
<a name="l01101"></a>01101         <span class="keywordflow">return</span> defined(<span class="stringliteral">'FPDF_FONTPATH'</span>) ? FPDF_FONTPATH : <span class="stringliteral">''</span>;
<a name="l01102"></a>01102 }
<a name="l01103"></a>01103 
<a name="l01104"></a><a class="code" href="class_f_p_d_f.html#4a539c5d31c9caf6ff6674d0621e2ce6">01104</a> function <a class="code" href="class_f_p_d_f.html#4a539c5d31c9caf6ff6674d0621e2ce6">_beginpage</a>($orientation, $format)
<a name="l01105"></a>01105 {
<a name="l01106"></a>01106         $this-&gt;page++;
<a name="l01107"></a>01107         $this-&gt;pages[$this-&gt;page]=<span class="stringliteral">''</span>;
<a name="l01108"></a>01108         $this-&gt;state=2;
<a name="l01109"></a>01109         $this-&gt;x=$this-&gt;lMargin;
<a name="l01110"></a>01110         $this-&gt;y=$this-&gt;tMargin;
<a name="l01111"></a>01111         $this-&gt;FontFamily=<span class="stringliteral">''</span>;
<a name="l01112"></a>01112         <span class="comment">//Check page size</span>
<a name="l01113"></a>01113         <span class="keywordflow">if</span>($orientation==<span class="stringliteral">''</span>)
<a name="l01114"></a>01114                 $orientation=$this-&gt;DefOrientation;
<a name="l01115"></a>01115         <span class="keywordflow">else</span>
<a name="l01116"></a>01116                 $orientation=strtoupper($orientation[0]);
<a name="l01117"></a>01117         <span class="keywordflow">if</span>($format==<span class="stringliteral">''</span>)
<a name="l01118"></a>01118                 $format=$this-&gt;DefPageFormat;
<a name="l01119"></a>01119         <span class="keywordflow">else</span>
<a name="l01120"></a>01120         {
<a name="l01121"></a>01121                 <span class="keywordflow">if</span>(is_string($format))
<a name="l01122"></a>01122                         $format=$this-&gt;<a class="code" href="class_f_p_d_f.html#12b4afff54d10102c052ec8618713df4">_getpageformat</a>($format);
<a name="l01123"></a>01123         }
<a name="l01124"></a>01124         <span class="keywordflow">if</span>($orientation!=$this-&gt;CurOrientation || $format[0]!=$this-&gt;CurPageFormat[0] || $format[1]!=$this-&gt;CurPageFormat[1])
<a name="l01125"></a>01125         {
<a name="l01126"></a>01126                 <span class="comment">//New size</span>
<a name="l01127"></a>01127                 <span class="keywordflow">if</span>($orientation==<span class="charliteral">'P'</span>)
<a name="l01128"></a>01128                 {
<a name="l01129"></a>01129                         $this-&gt;w=$format[0];
<a name="l01130"></a>01130                         $this-&gt;h=$format[1];
<a name="l01131"></a>01131                 }
<a name="l01132"></a>01132                 <span class="keywordflow">else</span>
<a name="l01133"></a>01133                 {
<a name="l01134"></a>01134                         $this-&gt;w=$format[1];
<a name="l01135"></a>01135                         $this-&gt;h=$format[0];
<a name="l01136"></a>01136                 }
<a name="l01137"></a>01137                 $this-&gt;wPt=$this-&gt;w*$this-&gt;k;
<a name="l01138"></a>01138                 $this-&gt;hPt=$this-&gt;h*$this-&gt;k;
<a name="l01139"></a>01139                 $this-&gt;PageBreakTrigger=$this-&gt;h-$this-&gt;bMargin;
<a name="l01140"></a>01140                 $this-&gt;CurOrientation=$orientation;
<a name="l01141"></a>01141                 $this-&gt;CurPageFormat=$format;
<a name="l01142"></a>01142         }
<a name="l01143"></a>01143         <span class="keywordflow">if</span>($orientation!=$this-&gt;DefOrientation || $format[0]!=$this-&gt;DefPageFormat[0] || $format[1]!=$this-&gt;DefPageFormat[1])
<a name="l01144"></a>01144                 $this-&gt;PageSizes[$this-&gt;page]=array($this-&gt;wPt, $this-&gt;hPt);
<a name="l01145"></a>01145 }
<a name="l01146"></a>01146 
<a name="l01147"></a><a class="code" href="class_f_p_d_f.html#0c727a46d970b65e123da12e3cb34b58">01147</a> function <a class="code" href="class_f_p_d_f.html#0c727a46d970b65e123da12e3cb34b58">_endpage</a>()
<a name="l01148"></a>01148 {
<a name="l01149"></a>01149         $this-&gt;state=1;
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 
<a name="l01152"></a><a class="code" href="class_f_p_d_f.html#315a57aaf556052008dd99ff196b812e">01152</a> function <a class="code" href="class_f_p_d_f.html#315a57aaf556052008dd99ff196b812e">_escape</a>($s)
<a name="l01153"></a>01153 {
<a name="l01154"></a>01154         <span class="comment">//Escape special characters in strings</span>
<a name="l01155"></a>01155         $s=str_replace(<span class="charliteral">'\\'</span>,<span class="stringliteral">'\\\\'</span>,$s);
<a name="l01156"></a>01156         $s=str_replace(<span class="charliteral">'('</span>,<span class="stringliteral">'\\('</span>,$s);
<a name="l01157"></a>01157         $s=str_replace(<span class="charliteral">')'</span>,<span class="stringliteral">'\\)'</span>,$s);
<a name="l01158"></a>01158         $s=str_replace(<span class="stringliteral">"\r"</span>,<span class="stringliteral">'\\r'</span>,$s);
<a name="l01159"></a>01159         <span class="keywordflow">return</span> $s;
<a name="l01160"></a>01160 }
<a name="l01161"></a>01161 
<a name="l01162"></a><a class="code" href="class_f_p_d_f.html#7a9f870d2548f450a8bc90f59b96656d">01162</a> function <a class="code" href="class_f_p_d_f.html#7a9f870d2548f450a8bc90f59b96656d">_textstring</a>($s)
<a name="l01163"></a>01163 {
<a name="l01164"></a>01164         <span class="comment">//Format a text string</span>
<a name="l01165"></a>01165         <span class="keywordflow">return</span> <span class="charliteral">'('</span>.$this-&gt;_escape($s).<span class="charliteral">')'</span>;
<a name="l01166"></a>01166 }
<a name="l01167"></a>01167 
<a name="l01168"></a><a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">01168</a> function <a class="code" href="class_f_p_d_f.html#e0d452fb23ac5d8bf11c17fbb96824ac">_UTF8toUTF16</a>($s)
<a name="l01169"></a>01169 {
<a name="l01170"></a>01170         <span class="comment">//Convert UTF-8 to UTF-16BE with BOM</span>
<a name="l01171"></a>01171         $res=<span class="stringliteral">"\xFE\xFF"</span>;
<a name="l01172"></a>01172         $nb=strlen($s);
<a name="l01173"></a>01173         $i=0;
<a name="l01174"></a>01174         <span class="keywordflow">while</span>($i&lt;$nb)
<a name="l01175"></a>01175         {
<a name="l01176"></a>01176                 $c1=ord($s[$i++]);
<a name="l01177"></a>01177                 <span class="keywordflow">if</span>($c1&gt;=224)
<a name="l01178"></a>01178                 {
<a name="l01179"></a>01179                         <span class="comment">//3-byte character</span>
<a name="l01180"></a>01180                         $c2=ord($s[$i++]);
<a name="l01181"></a>01181                         $c3=ord($s[$i++]);
<a name="l01182"></a>01182                         $res.=chr((($c1 &amp; 0x0F)&lt;&lt;4) + (($c2 &amp; 0x3C)&gt;&gt;2));
<a name="l01183"></a>01183                         $res.=chr((($c2 &amp; 0x03)&lt;&lt;6) + ($c3 &amp; 0x3F));
<a name="l01184"></a>01184                 }
<a name="l01185"></a>01185                 elseif($c1&gt;=192)
<a name="l01186"></a>01186                 {
<a name="l01187"></a>01187                         <span class="comment">//2-byte character</span>
<a name="l01188"></a>01188                         $c2=ord($s[$i++]);
<a name="l01189"></a>01189                         $res.=chr(($c1 &amp; 0x1C)&gt;&gt;2);
<a name="l01190"></a>01190                         $res.=chr((($c1 &amp; 0x03)&lt;&lt;6) + ($c2 &amp; 0x3F));
<a name="l01191"></a>01191                 }
<a name="l01192"></a>01192                 <span class="keywordflow">else</span>
<a name="l01193"></a>01193                 {
<a name="l01194"></a>01194                         <span class="comment">//Single-byte character</span>
<a name="l01195"></a>01195                         $res.=<span class="stringliteral">"\0"</span>.chr($c1);
<a name="l01196"></a>01196                 }
<a name="l01197"></a>01197         }
<a name="l01198"></a>01198         <span class="keywordflow">return</span> $res;
<a name="l01199"></a>01199 }
<a name="l01200"></a>01200 
<a name="l01201"></a><a class="code" href="class_f_p_d_f.html#35c042a9f396daa571e91a16ea65edc4">01201</a> function <a class="code" href="class_f_p_d_f.html#35c042a9f396daa571e91a16ea65edc4">_dounderline</a>(<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>, <a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>, $txt)
<a name="l01202"></a>01202 {
<a name="l01203"></a>01203         <span class="comment">//Underline text</span>
<a name="l01204"></a>01204         $up=$this-&gt;CurrentFont[<span class="stringliteral">'up'</span>];
<a name="l01205"></a>01205         $ut=$this-&gt;CurrentFont[<span class="stringliteral">'ut'</span>];
<a name="l01206"></a>01206         <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#55c99f3416c3788c759249b6315c948a">GetStringWidth</a>($txt)+$this-&gt;ws*substr_count($txt,<span class="charliteral">' '</span>);
<a name="l01207"></a>01207         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">'%.2F %.2F %.2F %.2F re f'</span>,<a class="code" href="class_f_p_d_f.html#84095b43bfc305f0b52c02075cb8674c">$x</a>*$this-&gt;k,($this-&gt;h-(<a class="code" href="class_f_p_d_f.html#9183f42c12c75728174c0e36aefc3144">$y</a>-$up/1000*$this-&gt;FontSize))*$this-&gt;k,<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>*$this-&gt;k,-$ut/1000*$this-&gt;FontSizePt);
<a name="l01208"></a>01208 }
<a name="l01209"></a>01209 
<a name="l01210"></a><a class="code" href="class_f_p_d_f.html#a0f75e695bf426888c0dc7d3a9635e22">01210</a> function <a class="code" href="class_f_p_d_f.html#a0f75e695bf426888c0dc7d3a9635e22">_parsejpg</a>($file)
<a name="l01211"></a>01211 {
<a name="l01212"></a>01212         <span class="comment">//Extract info from a JPEG file</span>
<a name="l01213"></a>01213         $a=GetImageSize($file);
<a name="l01214"></a>01214         <span class="keywordflow">if</span>(!$a)
<a name="l01215"></a>01215                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Missing or incorrect image file: '</span>.$file);
<a name="l01216"></a>01216         <span class="keywordflow">if</span>($a[2]!=2)
<a name="l01217"></a>01217                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Not a JPEG file: '</span>.$file);
<a name="l01218"></a>01218         <span class="keywordflow">if</span>(!isset($a[<span class="stringliteral">'channels'</span>]) || $a[<span class="stringliteral">'channels'</span>]==3)
<a name="l01219"></a>01219                 $colspace=<span class="stringliteral">'DeviceRGB'</span>;
<a name="l01220"></a>01220         elseif($a[<span class="stringliteral">'channels'</span>]==4)
<a name="l01221"></a>01221                 $colspace=<span class="stringliteral">'DeviceCMYK'</span>;
<a name="l01222"></a>01222         <span class="keywordflow">else</span>
<a name="l01223"></a>01223                 $colspace=<span class="stringliteral">'DeviceGray'</span>;
<a name="l01224"></a>01224         $bpc=isset($a[<span class="stringliteral">'bits'</span>]) ? $a[<span class="stringliteral">'bits'</span>] : 8;
<a name="l01225"></a>01225         <span class="comment">//Read whole file</span>
<a name="l01226"></a>01226         $f=fopen($file,<span class="stringliteral">'rb'</span>);
<a name="l01227"></a>01227         $data=<span class="stringliteral">''</span>;
<a name="l01228"></a>01228         <span class="keywordflow">while</span>(!feof($f))
<a name="l01229"></a>01229                 $data.=fread($f,8192);
<a name="l01230"></a>01230         fclose($f);
<a name="l01231"></a>01231         <span class="keywordflow">return</span> array(<span class="charliteral">'w'</span>=&gt;$a[0], <span class="charliteral">'h'</span>=&gt;$a[1], <span class="stringliteral">'cs'</span>=&gt;$colspace, <span class="stringliteral">'bpc'</span>=&gt;$bpc, <span class="charliteral">'f'</span>=&gt;<span class="stringliteral">'DCTDecode'</span>, <span class="stringliteral">'data'</span>=&gt;$data);
<a name="l01232"></a>01232 }
<a name="l01233"></a>01233 
<a name="l01234"></a><a class="code" href="class_f_p_d_f.html#5d9bff475aeba54667a4dbc058b1517b">01234</a> function <a class="code" href="class_f_p_d_f.html#5d9bff475aeba54667a4dbc058b1517b">_parsepng</a>($file)
<a name="l01235"></a>01235 {
<a name="l01236"></a>01236         <span class="comment">//Extract info from a PNG file</span>
<a name="l01237"></a>01237         $f=fopen($file,<span class="stringliteral">'rb'</span>);
<a name="l01238"></a>01238         <span class="keywordflow">if</span>(!$f)
<a name="l01239"></a>01239                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Can\'t open image file: '</span>.$file);
<a name="l01240"></a>01240         <span class="comment">//Check signature</span>
<a name="l01241"></a>01241         <span class="keywordflow">if</span>($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,8)!=chr(137).<span class="stringliteral">'PNG'</span>.chr(13).chr(10).chr(26).chr(10))
<a name="l01242"></a>01242                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Not a PNG file: '</span>.$file);
<a name="l01243"></a>01243         <span class="comment">//Read header chunk</span>
<a name="l01244"></a>01244         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01245"></a>01245         <span class="keywordflow">if</span>($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4)!=<span class="stringliteral">'IHDR'</span>)
<a name="l01246"></a>01246                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Incorrect PNG file: '</span>.$file);
<a name="l01247"></a>01247         <a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#0d76d528045f895215a9bc0c16c8aad5">_readint</a>($f);
<a name="l01248"></a>01248         <a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>=$this-&gt;<a class="code" href="class_f_p_d_f.html#0d76d528045f895215a9bc0c16c8aad5">_readint</a>($f);
<a name="l01249"></a>01249         $bpc=ord($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,1));
<a name="l01250"></a>01250         <span class="keywordflow">if</span>($bpc&gt;8)
<a name="l01251"></a>01251                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'16-bit depth not supported: '</span>.$file);
<a name="l01252"></a>01252         $ct=ord($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,1));
<a name="l01253"></a>01253         <span class="keywordflow">if</span>($ct==0)
<a name="l01254"></a>01254                 $colspace=<span class="stringliteral">'DeviceGray'</span>;
<a name="l01255"></a>01255         elseif($ct==2)
<a name="l01256"></a>01256                 $colspace=<span class="stringliteral">'DeviceRGB'</span>;
<a name="l01257"></a>01257         elseif($ct==3)
<a name="l01258"></a>01258                 $colspace=<span class="stringliteral">'Indexed'</span>;
<a name="l01259"></a>01259         <span class="keywordflow">else</span>
<a name="l01260"></a>01260                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Alpha channel not supported: '</span>.$file);
<a name="l01261"></a>01261         <span class="keywordflow">if</span>(ord($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,1))!=0)
<a name="l01262"></a>01262                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Unknown compression method: '</span>.$file);
<a name="l01263"></a>01263         <span class="keywordflow">if</span>(ord($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,1))!=0)
<a name="l01264"></a>01264                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Unknown filter method: '</span>.$file);
<a name="l01265"></a>01265         <span class="keywordflow">if</span>(ord($this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,1))!=0)
<a name="l01266"></a>01266                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Interlacing not supported: '</span>.$file);
<a name="l01267"></a>01267         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01268"></a>01268         $parms=<span class="stringliteral">'/DecodeParms &lt;&lt;/Predictor 15 /Colors '</span>.($ct==2 ? 3 : 1).<span class="stringliteral">' /BitsPerComponent '</span>.$bpc.<span class="stringliteral">' /Columns '</span>.<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>.<span class="stringliteral">'&gt;&gt;'</span>;
<a name="l01269"></a>01269         <span class="comment">//Scan chunks looking for palette, transparency and image data</span>
<a name="l01270"></a>01270         $pal=<span class="stringliteral">''</span>;
<a name="l01271"></a>01271         $trns=<span class="stringliteral">''</span>;
<a name="l01272"></a>01272         $data=<span class="stringliteral">''</span>;
<a name="l01273"></a>01273         <span class="keywordflow">do</span>
<a name="l01274"></a>01274         {
<a name="l01275"></a>01275                 <a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>=$this-&gt;_readint($f);
<a name="l01276"></a>01276                 $type=$this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01277"></a>01277                 <span class="keywordflow">if</span>($type==<span class="stringliteral">'PLTE'</span>)
<a name="l01278"></a>01278                 {
<a name="l01279"></a>01279                         <span class="comment">//Read palette</span>
<a name="l01280"></a>01280                         $pal=$this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>);
<a name="l01281"></a>01281                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01282"></a>01282                 }
<a name="l01283"></a>01283                 elseif($type==<span class="stringliteral">'tRNS'</span>)
<a name="l01284"></a>01284                 {
<a name="l01285"></a>01285                         <span class="comment">//Read transparency info</span>
<a name="l01286"></a>01286                         $t=$this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>);
<a name="l01287"></a>01287                         <span class="keywordflow">if</span>($ct==0)
<a name="l01288"></a>01288                                 $trns=array(ord(substr($t,1,1)));
<a name="l01289"></a>01289                         elseif($ct==2)
<a name="l01290"></a>01290                                 $trns=array(ord(substr($t,1,1)), ord(substr($t,3,1)), ord(substr($t,5,1)));
<a name="l01291"></a>01291                         <span class="keywordflow">else</span>
<a name="l01292"></a>01292                         {
<a name="l01293"></a>01293                                 $pos=strpos($t,chr(0));
<a name="l01294"></a>01294                                 <span class="keywordflow">if</span>($pos!==<span class="keyword">false</span>)
<a name="l01295"></a>01295                                         $trns=array($pos);
<a name="l01296"></a>01296                         }
<a name="l01297"></a>01297                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01298"></a>01298                 }
<a name="l01299"></a>01299                 elseif($type==<span class="stringliteral">'IDAT'</span>)
<a name="l01300"></a>01300                 {
<a name="l01301"></a>01301                         <span class="comment">//Read image data block</span>
<a name="l01302"></a>01302                         $data.=$this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>);
<a name="l01303"></a>01303                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,4);
<a name="l01304"></a>01304                 }
<a name="l01305"></a>01305                 elseif($type==<span class="stringliteral">'IEND'</span>)
<a name="l01306"></a>01306                         <span class="keywordflow">break</span>;
<a name="l01307"></a>01307                 <span class="keywordflow">else</span>
<a name="l01308"></a>01308                         $this-&gt;<a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">_readstream</a>($f,<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>+4);
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310         <span class="keywordflow">while</span>(<a class="code" href="class_f_p_d_f.html#718a78c2c592d0a027429947df12d161">$n</a>);
<a name="l01311"></a>01311         <span class="keywordflow">if</span>($colspace==<span class="stringliteral">'Indexed'</span> &amp;&amp; empty($pal))
<a name="l01312"></a>01312                 $this-&gt;<a class="code" href="class_f_p_d_f.html#bbf9af8630c425b22b9199cc906ee1bb">Error</a>(<span class="stringliteral">'Missing palette in '</span>.$file);
<a name="l01313"></a>01313         fclose($f);
<a name="l01314"></a>01314         <span class="keywordflow">return</span> array(<span class="charliteral">'w'</span>=&gt;<a class="code" href="class_f_p_d_f.html#dcb78dac68c4b261fab2a9c03de77177">$w</a>, <span class="charliteral">'h'</span>=&gt;<a class="code" href="class_f_p_d_f.html#6bb420fc8cb8cf3d2218bb9148394999">$h</a>, <span class="stringliteral">'cs'</span>=&gt;$colspace, <span class="stringliteral">'bpc'</span>=&gt;$bpc, <span class="charliteral">'f'</span>=&gt;<span class="stringliteral">'FlateDecode'</span>, <span class="stringliteral">'parms'</span>=&gt;$parms, <span class="stringliteral">'pal'</span>=&gt;$pal, <span class="stringliteral">'trns'</span>=&gt;$trns, <span class="stringliteral">'data'</span>=&gt;$data);
<a name="l01315"></a>01315 }
<a name="l01316"></a>01316 
<a name="l01317"></a><a class="code" href="class_f_p_d_f.html#bdc4f5232eab0e2bfc86570c07d44688">01317</a> function _readstream($f, $n)
<a name="l01318"></a>01318 {
<a name="l01319"></a>01319         <span class="comment">//Read n bytes from stream</span>
<a name="l01320"></a>01320         $res=<span class="stringliteral">''</span>;
<a name="l01321"></a>01321         <span class="keywordflow">while</span>($n&gt;0 &amp;&amp; !feof($f))
<a name="l01322"></a>01322         {
<a name="l01323"></a>01323                 $s=fread($f,$n);
<a name="l01324"></a>01324                 <span class="keywordflow">if</span>($s===<span class="keyword">false</span>)
<a name="l01325"></a>01325                         $this-&gt;Error(<span class="stringliteral">'Error while reading stream'</span>);
<a name="l01326"></a>01326                 $n-=strlen($s);
<a name="l01327"></a>01327                 $res.=$s;
<a name="l01328"></a>01328         }
<a name="l01329"></a>01329         <span class="keywordflow">if</span>($n&gt;0)
<a name="l01330"></a>01330                 $this-&gt;Error(<span class="stringliteral">'Unexpected end of stream'</span>);
<a name="l01331"></a>01331         <span class="keywordflow">return</span> $res;
<a name="l01332"></a>01332 }
<a name="l01333"></a>01333 
<a name="l01334"></a><a class="code" href="class_f_p_d_f.html#0d76d528045f895215a9bc0c16c8aad5">01334</a> function _readint($f)
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336         <span class="comment">//Read a 4-byte integer from stream</span>
<a name="l01337"></a>01337         $a=unpack(<span class="stringliteral">'Ni'</span>,$this-&gt;_readstream($f,4));
<a name="l01338"></a>01338         <span class="keywordflow">return</span> $a[<span class="charliteral">'i'</span>];
<a name="l01339"></a>01339 }
<a name="l01340"></a>01340 
<a name="l01341"></a><a class="code" href="class_f_p_d_f.html#3c95d5d6ce5651c4cf53cd88e82982b8">01341</a> function _parsegif($file)
<a name="l01342"></a>01342 {
<a name="l01343"></a>01343         <span class="comment">//Extract info from a GIF file (via PNG conversion)</span>
<a name="l01344"></a>01344         <span class="keywordflow">if</span>(!function_exists(<span class="stringliteral">'imagepng'</span>))
<a name="l01345"></a>01345                 $this-&gt;Error(<span class="stringliteral">'GD extension is required for GIF support'</span>);
<a name="l01346"></a>01346         <span class="keywordflow">if</span>(!function_exists(<span class="stringliteral">'imagecreatefromgif'</span>))
<a name="l01347"></a>01347                 $this-&gt;Error(<span class="stringliteral">'GD has no GIF read support'</span>);
<a name="l01348"></a>01348         $im=imagecreatefromgif($file);
<a name="l01349"></a>01349         <span class="keywordflow">if</span>(!$im)
<a name="l01350"></a>01350                 $this-&gt;Error(<span class="stringliteral">'Missing or incorrect image file: '</span>.$file);
<a name="l01351"></a>01351         imageinterlace($im,0);
<a name="l01352"></a>01352         $tmp=tempnam(<span class="charliteral">'.'</span>,<span class="stringliteral">'gif'</span>);
<a name="l01353"></a>01353         <span class="keywordflow">if</span>(!$tmp)
<a name="l01354"></a>01354                 $this-&gt;Error(<span class="stringliteral">'Unable to create a temporary file'</span>);
<a name="l01355"></a>01355         <span class="keywordflow">if</span>(!imagepng($im,$tmp))
<a name="l01356"></a>01356                 $this-&gt;Error(<span class="stringliteral">'Error while saving to temporary file'</span>);
<a name="l01357"></a>01357         imagedestroy($im);
<a name="l01358"></a>01358         $info=$this-&gt;_parsepng($tmp);
<a name="l01359"></a>01359         unlink($tmp);
<a name="l01360"></a>01360         <span class="keywordflow">return</span> $info;
<a name="l01361"></a>01361 }
<a name="l01362"></a>01362 
<a name="l01363"></a><a class="code" href="class_f_p_d_f.html#df8bee44dbc72dd22396e57e1dd955d8">01363</a> function _newobj()
<a name="l01364"></a>01364 {
<a name="l01365"></a>01365         <span class="comment">//Begin a new object</span>
<a name="l01366"></a>01366         $this-&gt;n++;
<a name="l01367"></a>01367         $this-&gt;offsets[$this-&gt;n]=strlen($this-&gt;buffer);
<a name="l01368"></a>01368         $this-&gt;_out($this-&gt;n.<span class="stringliteral">' 0 obj'</span>);
<a name="l01369"></a>01369 }
<a name="l01370"></a>01370 
<a name="l01371"></a><a class="code" href="class_f_p_d_f.html#7ce4eca35f608d38161ab60809cdd0cf">01371</a> function _putstream($s)
<a name="l01372"></a>01372 {
<a name="l01373"></a>01373         $this-&gt;_out(<span class="stringliteral">'stream'</span>);
<a name="l01374"></a>01374         $this-&gt;_out($s);
<a name="l01375"></a>01375         $this-&gt;_out(<span class="stringliteral">'endstream'</span>);
<a name="l01376"></a>01376 }
<a name="l01377"></a>01377 
<a name="l01378"></a><a class="code" href="class_f_p_d_f.html#01f1638c57a38691668dbf5a7bdf9852">01378</a> function _out($s)
<a name="l01379"></a>01379 {
<a name="l01380"></a>01380         <span class="comment">//Add a line to the document</span>
<a name="l01381"></a>01381         <span class="keywordflow">if</span>($this-&gt;state==2)
<a name="l01382"></a>01382                 $this-&gt;pages[$this-&gt;page].=$s.<span class="stringliteral">"\n"</span>;
<a name="l01383"></a>01383         <span class="keywordflow">else</span>
<a name="l01384"></a>01384                 $this-&gt;buffer.=$s.<span class="stringliteral">"\n"</span>;
<a name="l01385"></a>01385 }
<a name="l01386"></a>01386 
<a name="l01387"></a><a class="code" href="class_f_p_d_f.html#01951b3fad634e87f5ab6763d6444476">01387</a> function _putpages()
<a name="l01388"></a>01388 {
<a name="l01389"></a>01389         $nb=$this-&gt;page;
<a name="l01390"></a>01390         <span class="keywordflow">if</span>(!empty($this-&gt;AliasNbPages))
<a name="l01391"></a>01391         {
<a name="l01392"></a>01392                 <span class="comment">//Replace number of pages</span>
<a name="l01393"></a>01393                 <span class="keywordflow">for</span>($n=1;$n&lt;=$nb;$n++)
<a name="l01394"></a>01394                         $this-&gt;pages[$n]=str_replace($this-&gt;AliasNbPages,$nb,$this-&gt;pages[$n]);
<a name="l01395"></a>01395         }
<a name="l01396"></a>01396         <span class="keywordflow">if</span>($this-&gt;DefOrientation==<span class="charliteral">'P'</span>)
<a name="l01397"></a>01397         {
<a name="l01398"></a>01398                 $wPt=$this-&gt;DefPageFormat[0]*$this-&gt;k;
<a name="l01399"></a>01399                 $hPt=$this-&gt;DefPageFormat[1]*$this-&gt;k;
<a name="l01400"></a>01400         }
<a name="l01401"></a>01401         <span class="keywordflow">else</span>
<a name="l01402"></a>01402         {
<a name="l01403"></a>01403                 $wPt=$this-&gt;DefPageFormat[1]*$this-&gt;k;
<a name="l01404"></a>01404                 $hPt=$this-&gt;DefPageFormat[0]*$this-&gt;k;
<a name="l01405"></a>01405         }
<a name="l01406"></a>01406         $filter=($this-&gt;compress) ? <span class="stringliteral">'/Filter /FlateDecode '</span> : <span class="stringliteral">''</span>;
<a name="l01407"></a>01407         <span class="keywordflow">for</span>($n=1;$n&lt;=$nb;$n++)
<a name="l01408"></a>01408         {
<a name="l01409"></a>01409                 <span class="comment">//Page</span>
<a name="l01410"></a>01410                 $this-&gt;_newobj();
<a name="l01411"></a>01411                 $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /Page'</span>);
<a name="l01412"></a>01412                 $this-&gt;_out(<span class="stringliteral">'/Parent 1 0 R'</span>);
<a name="l01413"></a>01413                 <span class="keywordflow">if</span>(isset($this-&gt;PageSizes[$n]))
<a name="l01414"></a>01414                         $this-&gt;_out(sprintf(<span class="stringliteral">'/MediaBox [0 0 %.2F %.2F]'</span>,$this-&gt;PageSizes[$n][0],$this-&gt;PageSizes[$n][1]));
<a name="l01415"></a>01415                 $this-&gt;_out(<span class="stringliteral">'/Resources 2 0 R'</span>);
<a name="l01416"></a>01416                 <span class="keywordflow">if</span>(isset($this-&gt;PageLinks[$n]))
<a name="l01417"></a>01417                 {
<a name="l01418"></a>01418                         <span class="comment">//Links</span>
<a name="l01419"></a>01419                         $annots=<span class="stringliteral">'/Annots ['</span>;
<a name="l01420"></a>01420                         <span class="keywordflow">foreach</span>($this-&gt;PageLinks[$n] as $pl)
<a name="l01421"></a>01421                         {
<a name="l01422"></a>01422                                 $rect=sprintf(<span class="stringliteral">'%.2F %.2F %.2F %.2F'</span>,$pl[0],$pl[1],$pl[0]+$pl[2],$pl[1]-$pl[3]);
<a name="l01423"></a>01423                                 $annots.=<span class="stringliteral">'&lt;&lt;/Type /Annot /Subtype /Link /Rect ['</span>.$rect.<span class="stringliteral">'] /Border [0 0 0] '</span>;
<a name="l01424"></a>01424                                 <span class="keywordflow">if</span>(is_string($pl[4]))
<a name="l01425"></a>01425                                         $annots.=<span class="stringliteral">'/A &lt;&lt;/S /URI /URI '</span>.$this-&gt;_textstring($pl[4]).<span class="stringliteral">'&gt;&gt;&gt;&gt;'</span>;
<a name="l01426"></a>01426                                 <span class="keywordflow">else</span>
<a name="l01427"></a>01427                                 {
<a name="l01428"></a>01428                                         $l=$this-&gt;links[$pl[4]];
<a name="l01429"></a>01429                                         $h=isset($this-&gt;PageSizes[$l[0]]) ? $this-&gt;PageSizes[$l[0]][1] : $hPt;
<a name="l01430"></a>01430                                         $annots.=sprintf(<span class="stringliteral">'/Dest [%d 0 R /XYZ 0 %.2F null]&gt;&gt;'</span>,1+2*$l[0],$h-$l[1]*$this-&gt;k);
<a name="l01431"></a>01431                                 }
<a name="l01432"></a>01432                         }
<a name="l01433"></a>01433                         $this-&gt;_out($annots.<span class="charliteral">']'</span>);
<a name="l01434"></a>01434                 }
<a name="l01435"></a>01435                 $this-&gt;_out(<span class="stringliteral">'/Contents '</span>.($this-&gt;n+1).<span class="stringliteral">' 0 R&gt;&gt;'</span>);
<a name="l01436"></a>01436                 $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01437"></a>01437                 <span class="comment">//Page content</span>
<a name="l01438"></a>01438                 $p=($this-&gt;compress) ? gzcompress($this-&gt;pages[$n]) : $this-&gt;pages[$n];
<a name="l01439"></a>01439                 $this-&gt;_newobj();
<a name="l01440"></a>01440                 $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>.$filter.<span class="stringliteral">'/Length '</span>.strlen($p).<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01441"></a>01441                 $this-&gt;_putstream($p);
<a name="l01442"></a>01442                 $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01443"></a>01443         }
<a name="l01444"></a>01444         <span class="comment">//Pages root</span>
<a name="l01445"></a>01445         $this-&gt;offsets[1]=strlen($this-&gt;buffer);
<a name="l01446"></a>01446         $this-&gt;_out(<span class="stringliteral">'1 0 obj'</span>);
<a name="l01447"></a>01447         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /Pages'</span>);
<a name="l01448"></a>01448         $kids=<span class="stringliteral">'/Kids ['</span>;
<a name="l01449"></a>01449         <span class="keywordflow">for</span>($i=0;$i&lt;$nb;$i++)
<a name="l01450"></a>01450                 $kids.=(3+2*$i).<span class="stringliteral">' 0 R '</span>;
<a name="l01451"></a>01451         $this-&gt;_out($kids.<span class="charliteral">']'</span>);
<a name="l01452"></a>01452         $this-&gt;_out(<span class="stringliteral">'/Count '</span>.$nb);
<a name="l01453"></a>01453         $this-&gt;_out(sprintf(<span class="stringliteral">'/MediaBox [0 0 %.2F %.2F]'</span>,$wPt,$hPt));
<a name="l01454"></a>01454         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01455"></a>01455         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01456"></a>01456 }
<a name="l01457"></a>01457 
<a name="l01458"></a><a class="code" href="class_f_p_d_f.html#283308a9c41ca18f57649d60f312d7d1">01458</a> function _putfonts()
<a name="l01459"></a>01459 {
<a name="l01460"></a>01460         $nf=$this-&gt;n;
<a name="l01461"></a>01461         <span class="keywordflow">foreach</span>($this-&gt;diffs as $diff)
<a name="l01462"></a>01462         {
<a name="l01463"></a>01463                 <span class="comment">//Encodings</span>
<a name="l01464"></a>01464                 $this-&gt;_newobj();
<a name="l01465"></a>01465                 $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences ['</span>.$diff.<span class="stringliteral">']&gt;&gt;'</span>);
<a name="l01466"></a>01466                 $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01467"></a>01467         }
<a name="l01468"></a>01468         <span class="keywordflow">foreach</span>($this-&gt;FontFiles as $file=&gt;$info)
<a name="l01469"></a>01469         {
<a name="l01470"></a>01470                 <span class="comment">//Font file embedding</span>
<a name="l01471"></a>01471                 $this-&gt;_newobj();
<a name="l01472"></a>01472                 $this-&gt;FontFiles[$file][<span class="charliteral">'n'</span>]=$this-&gt;n;
<a name="l01473"></a>01473                 $font=<span class="stringliteral">''</span>;
<a name="l01474"></a>01474                 $f=fopen($this-&gt;_getfontpath().$file,<span class="stringliteral">'rb'</span>,1);
<a name="l01475"></a>01475                 <span class="keywordflow">if</span>(!$f)
<a name="l01476"></a>01476                         $this-&gt;Error(<span class="stringliteral">'Font file not found'</span>);
<a name="l01477"></a>01477                 <span class="keywordflow">while</span>(!feof($f))
<a name="l01478"></a>01478                         $font.=fread($f,8192);
<a name="l01479"></a>01479                 fclose($f);
<a name="l01480"></a>01480                 $compressed=(substr($file,-2)==<span class="stringliteral">'.z'</span>);
<a name="l01481"></a>01481                 <span class="keywordflow">if</span>(!$compressed &amp;&amp; isset($info[<span class="stringliteral">'length2'</span>]))
<a name="l01482"></a>01482                 {
<a name="l01483"></a>01483                         $header=(ord($font[0])==128);
<a name="l01484"></a>01484                         <span class="keywordflow">if</span>($header)
<a name="l01485"></a>01485                         {
<a name="l01486"></a>01486                                 <span class="comment">//Strip first binary header</span>
<a name="l01487"></a>01487                                 $font=substr($font,6);
<a name="l01488"></a>01488                         }
<a name="l01489"></a>01489                         <span class="keywordflow">if</span>($header &amp;&amp; ord($font[$info[<span class="stringliteral">'length1'</span>]])==128)
<a name="l01490"></a>01490                         {
<a name="l01491"></a>01491                                 <span class="comment">//Strip second binary header</span>
<a name="l01492"></a>01492                                 $font=substr($font,0,$info[<span class="stringliteral">'length1'</span>]).substr($font,$info[<span class="stringliteral">'length1'</span>]+6);
<a name="l01493"></a>01493                         }
<a name="l01494"></a>01494                 }
<a name="l01495"></a>01495                 $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Length '</span>.strlen($font));
<a name="l01496"></a>01496                 <span class="keywordflow">if</span>($compressed)
<a name="l01497"></a>01497                         $this-&gt;_out(<span class="stringliteral">'/Filter /FlateDecode'</span>);
<a name="l01498"></a>01498                 $this-&gt;_out(<span class="stringliteral">'/Length1 '</span>.$info[<span class="stringliteral">'length1'</span>]);
<a name="l01499"></a>01499                 <span class="keywordflow">if</span>(isset($info[<span class="stringliteral">'length2'</span>]))
<a name="l01500"></a>01500                         $this-&gt;_out(<span class="stringliteral">'/Length2 '</span>.$info[<span class="stringliteral">'length2'</span>].<span class="stringliteral">' /Length3 0'</span>);
<a name="l01501"></a>01501                 $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01502"></a>01502                 $this-&gt;_putstream($font);
<a name="l01503"></a>01503                 $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01504"></a>01504         }
<a name="l01505"></a>01505         <span class="keywordflow">foreach</span>($this-&gt;fonts as $k=&gt;$font)
<a name="l01506"></a>01506         {
<a name="l01507"></a>01507                 <span class="comment">//Font objects</span>
<a name="l01508"></a>01508                 $this-&gt;fonts[$k][<span class="charliteral">'n'</span>]=$this-&gt;n+1;
<a name="l01509"></a>01509                 $type=$font[<span class="stringliteral">'type'</span>];
<a name="l01510"></a>01510                 $name=$font[<span class="stringliteral">'name'</span>];
<a name="l01511"></a>01511                 <span class="keywordflow">if</span>($type==<span class="stringliteral">'core'</span>)
<a name="l01512"></a>01512                 {
<a name="l01513"></a>01513                         <span class="comment">//Standard font</span>
<a name="l01514"></a>01514                         $this-&gt;_newobj();
<a name="l01515"></a>01515                         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /Font'</span>);
<a name="l01516"></a>01516                         $this-&gt;_out(<span class="stringliteral">'/BaseFont /'</span>.$name);
<a name="l01517"></a>01517                         $this-&gt;_out(<span class="stringliteral">'/Subtype /Type1'</span>);
<a name="l01518"></a>01518                         <span class="keywordflow">if</span>($name!=<span class="stringliteral">'Symbol'</span> &amp;&amp; $name!=<span class="stringliteral">'ZapfDingbats'</span>)
<a name="l01519"></a>01519                                 $this-&gt;_out(<span class="stringliteral">'/Encoding /WinAnsiEncoding'</span>);
<a name="l01520"></a>01520                         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01521"></a>01521                         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01522"></a>01522                 }
<a name="l01523"></a>01523                 elseif($type==<span class="stringliteral">'Type1'</span> || $type==<span class="stringliteral">'TrueType'</span>)
<a name="l01524"></a>01524                 {
<a name="l01525"></a>01525                         <span class="comment">//Additional Type1 or TrueType font</span>
<a name="l01526"></a>01526                         $this-&gt;_newobj();
<a name="l01527"></a>01527                         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /Font'</span>);
<a name="l01528"></a>01528                         $this-&gt;_out(<span class="stringliteral">'/BaseFont /'</span>.$name);
<a name="l01529"></a>01529                         $this-&gt;_out(<span class="stringliteral">'/Subtype /'</span>.$type);
<a name="l01530"></a>01530                         $this-&gt;_out(<span class="stringliteral">'/FirstChar 32 /LastChar 255'</span>);
<a name="l01531"></a>01531                         $this-&gt;_out(<span class="stringliteral">'/Widths '</span>.($this-&gt;n+1).<span class="stringliteral">' 0 R'</span>);
<a name="l01532"></a>01532                         $this-&gt;_out(<span class="stringliteral">'/FontDescriptor '</span>.($this-&gt;n+2).<span class="stringliteral">' 0 R'</span>);
<a name="l01533"></a>01533                         <span class="keywordflow">if</span>($font[<span class="stringliteral">'enc'</span>])
<a name="l01534"></a>01534                         {
<a name="l01535"></a>01535                                 <span class="keywordflow">if</span>(isset($font[<span class="stringliteral">'diff'</span>]))
<a name="l01536"></a>01536                                         $this-&gt;_out(<span class="stringliteral">'/Encoding '</span>.($nf+$font[<span class="stringliteral">'diff'</span>]).<span class="stringliteral">' 0 R'</span>);
<a name="l01537"></a>01537                                 <span class="keywordflow">else</span>
<a name="l01538"></a>01538                                         $this-&gt;_out(<span class="stringliteral">'/Encoding /WinAnsiEncoding'</span>);
<a name="l01539"></a>01539                         }
<a name="l01540"></a>01540                         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01541"></a>01541                         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01542"></a>01542                         <span class="comment">//Widths</span>
<a name="l01543"></a>01543                         $this-&gt;_newobj();
<a name="l01544"></a>01544                         $cw=&amp;$font[<span class="stringliteral">'cw'</span>];
<a name="l01545"></a>01545                         $s=<span class="charliteral">'['</span>;
<a name="l01546"></a>01546                         <span class="keywordflow">for</span>($i=32;$i&lt;=255;$i++)
<a name="l01547"></a>01547                                 $s.=$cw[chr($i)].<span class="charliteral">' '</span>;
<a name="l01548"></a>01548                         $this-&gt;_out($s.<span class="charliteral">']'</span>);
<a name="l01549"></a>01549                         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01550"></a>01550                         <span class="comment">//Descriptor</span>
<a name="l01551"></a>01551                         $this-&gt;_newobj();
<a name="l01552"></a>01552                         $s=<span class="stringliteral">'&lt;&lt;/Type /FontDescriptor /FontName /'</span>.$name;
<a name="l01553"></a>01553                         <span class="keywordflow">foreach</span>($font[<span class="stringliteral">'desc'</span>] as $k=&gt;$v)
<a name="l01554"></a>01554                                 $s.=<span class="stringliteral">' /'</span>.$k.<span class="charliteral">' '</span>.$v;
<a name="l01555"></a>01555                         $file=$font[<span class="stringliteral">'file'</span>];
<a name="l01556"></a>01556                         <span class="keywordflow">if</span>($file)
<a name="l01557"></a>01557                                 $s.=<span class="stringliteral">' /FontFile'</span>.($type==<span class="stringliteral">'Type1'</span> ? <span class="stringliteral">''</span> : <span class="charliteral">'2'</span>).<span class="charliteral">' '</span>.$this-&gt;FontFiles[$file][<span class="charliteral">'n'</span>].<span class="stringliteral">' 0 R'</span>;
<a name="l01558"></a>01558                         $this-&gt;_out($s.<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01559"></a>01559                         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01560"></a>01560                 }
<a name="l01561"></a>01561                 <span class="keywordflow">else</span>
<a name="l01562"></a>01562                 {
<a name="l01563"></a>01563                         <span class="comment">//Allow for additional types</span>
<a name="l01564"></a>01564                         $mtd=<span class="stringliteral">'_put'</span>.strtolower($type);
<a name="l01565"></a>01565                         <span class="keywordflow">if</span>(!method_exists($this,$mtd))
<a name="l01566"></a>01566                                 $this-&gt;Error(<span class="stringliteral">'Unsupported font type: '</span>.$type);
<a name="l01567"></a>01567                         $this-&gt;$mtd($font);
<a name="l01568"></a>01568                 }
<a name="l01569"></a>01569         }
<a name="l01570"></a>01570 }
<a name="l01571"></a>01571 
<a name="l01572"></a><a class="code" href="class_f_p_d_f.html#b1f143c4ef408cb6287fa60b8dbdd8c4">01572</a> function _putimages()
<a name="l01573"></a>01573 {
<a name="l01574"></a>01574         $filter=($this-&gt;compress) ? <span class="stringliteral">'/Filter /FlateDecode '</span> : <span class="stringliteral">''</span>;
<a name="l01575"></a>01575         reset($this-&gt;images);
<a name="l01576"></a>01576         <span class="keywordflow">while</span>(list($file,$info)=each($this-&gt;images))
<a name="l01577"></a>01577         {
<a name="l01578"></a>01578                 $this-&gt;_newobj();
<a name="l01579"></a>01579                 $this-&gt;images[$file][<span class="charliteral">'n'</span>]=$this-&gt;n;
<a name="l01580"></a>01580                 $this-&gt;_out(<span class="stringliteral">'&lt;&lt;/Type /XObject'</span>);
<a name="l01581"></a>01581                 $this-&gt;_out(<span class="stringliteral">'/Subtype /Image'</span>);
<a name="l01582"></a>01582                 $this-&gt;_out(<span class="stringliteral">'/Width '</span>.$info[<span class="charliteral">'w'</span>]);
<a name="l01583"></a>01583                 $this-&gt;_out(<span class="stringliteral">'/Height '</span>.$info[<span class="charliteral">'h'</span>]);
<a name="l01584"></a>01584                 <span class="keywordflow">if</span>($info[<span class="stringliteral">'cs'</span>]==<span class="stringliteral">'Indexed'</span>)
<a name="l01585"></a>01585                         $this-&gt;_out(<span class="stringliteral">'/ColorSpace [/Indexed /DeviceRGB '</span>.(strlen($info[<span class="stringliteral">'pal'</span>])/3-1).<span class="charliteral">' '</span>.($this-&gt;n+1).<span class="stringliteral">' 0 R]'</span>);
<a name="l01586"></a>01586                 <span class="keywordflow">else</span>
<a name="l01587"></a>01587                 {
<a name="l01588"></a>01588                         $this-&gt;_out(<span class="stringliteral">'/ColorSpace /'</span>.$info[<span class="stringliteral">'cs'</span>]);
<a name="l01589"></a>01589                         <span class="keywordflow">if</span>($info[<span class="stringliteral">'cs'</span>]==<span class="stringliteral">'DeviceCMYK'</span>)
<a name="l01590"></a>01590                                 $this-&gt;_out(<span class="stringliteral">'/Decode [1 0 1 0 1 0 1 0]'</span>);
<a name="l01591"></a>01591                 }
<a name="l01592"></a>01592                 $this-&gt;_out(<span class="stringliteral">'/BitsPerComponent '</span>.$info[<span class="stringliteral">'bpc'</span>]);
<a name="l01593"></a>01593                 <span class="keywordflow">if</span>(isset($info[<span class="charliteral">'f'</span>]))
<a name="l01594"></a>01594                         $this-&gt;_out(<span class="stringliteral">'/Filter /'</span>.$info[<span class="charliteral">'f'</span>]);
<a name="l01595"></a>01595                 <span class="keywordflow">if</span>(isset($info[<span class="stringliteral">'parms'</span>]))
<a name="l01596"></a>01596                         $this-&gt;_out($info[<span class="stringliteral">'parms'</span>]);
<a name="l01597"></a>01597                 <span class="keywordflow">if</span>(isset($info[<span class="stringliteral">'trns'</span>]) &amp;&amp; is_array($info[<span class="stringliteral">'trns'</span>]))
<a name="l01598"></a>01598                 {
<a name="l01599"></a>01599                         $trns=<span class="stringliteral">''</span>;
<a name="l01600"></a>01600                         <span class="keywordflow">for</span>($i=0;$i&lt;count($info[<span class="stringliteral">'trns'</span>]);$i++)
<a name="l01601"></a>01601                                 $trns.=$info[<span class="stringliteral">'trns'</span>][$i].<span class="charliteral">' '</span>.$info[<span class="stringliteral">'trns'</span>][$i].<span class="charliteral">' '</span>;
<a name="l01602"></a>01602                         $this-&gt;_out(<span class="stringliteral">'/Mask ['</span>.$trns.<span class="charliteral">']'</span>);
<a name="l01603"></a>01603                 }
<a name="l01604"></a>01604                 $this-&gt;_out(<span class="stringliteral">'/Length '</span>.strlen($info[<span class="stringliteral">'data'</span>]).<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01605"></a>01605                 $this-&gt;_putstream($info[<span class="stringliteral">'data'</span>]);
<a name="l01606"></a>01606                 unset($this-&gt;images[$file][<span class="stringliteral">'data'</span>]);
<a name="l01607"></a>01607                 $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01608"></a>01608                 <span class="comment">//Palette</span>
<a name="l01609"></a>01609                 <span class="keywordflow">if</span>($info[<span class="stringliteral">'cs'</span>]==<span class="stringliteral">'Indexed'</span>)
<a name="l01610"></a>01610                 {
<a name="l01611"></a>01611                         $this-&gt;_newobj();
<a name="l01612"></a>01612                         $pal=($this-&gt;compress) ? gzcompress($info[<span class="stringliteral">'pal'</span>]) : $info[<span class="stringliteral">'pal'</span>];
<a name="l01613"></a>01613                         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>.$filter.<span class="stringliteral">'/Length '</span>.strlen($pal).<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01614"></a>01614                         $this-&gt;_putstream($pal);
<a name="l01615"></a>01615                         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01616"></a>01616                 }
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618 }
<a name="l01619"></a>01619 
<a name="l01620"></a><a class="code" href="class_f_p_d_f.html#61df2cca07c80226d3b671b8ac208214">01620</a> function _putxobjectdict()
<a name="l01621"></a>01621 {
<a name="l01622"></a>01622         <span class="keywordflow">foreach</span>($this-&gt;images as $image)
<a name="l01623"></a>01623                 $this-&gt;_out(<span class="stringliteral">'/I'</span>.$image[<span class="charliteral">'i'</span>].<span class="charliteral">' '</span>.$image[<span class="charliteral">'n'</span>].<span class="stringliteral">' 0 R'</span>);
<a name="l01624"></a>01624 }
<a name="l01625"></a>01625 
<a name="l01626"></a><a class="code" href="class_f_p_d_f.html#7681576bf6a875238ecdabd5fb4f36b8">01626</a> function _putresourcedict()
<a name="l01627"></a>01627 {
<a name="l01628"></a>01628         $this-&gt;_out(<span class="stringliteral">'/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]'</span>);
<a name="l01629"></a>01629         $this-&gt;_out(<span class="stringliteral">'/Font &lt;&lt;'</span>);
<a name="l01630"></a>01630         <span class="keywordflow">foreach</span>($this-&gt;fonts as $font)
<a name="l01631"></a>01631                 $this-&gt;_out(<span class="stringliteral">'/F'</span>.$font[<span class="charliteral">'i'</span>].<span class="charliteral">' '</span>.$font[<span class="charliteral">'n'</span>].<span class="stringliteral">' 0 R'</span>);
<a name="l01632"></a>01632         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01633"></a>01633         $this-&gt;_out(<span class="stringliteral">'/XObject &lt;&lt;'</span>);
<a name="l01634"></a>01634         $this-&gt;_putxobjectdict();
<a name="l01635"></a>01635         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01636"></a>01636 }
<a name="l01637"></a>01637 
<a name="l01638"></a><a class="code" href="class_f_p_d_f.html#2fb9db0c32c794a2535eb445b7fcaaca">01638</a> function _putresources()
<a name="l01639"></a>01639 {
<a name="l01640"></a>01640         $this-&gt;_putfonts();
<a name="l01641"></a>01641         $this-&gt;_putimages();
<a name="l01642"></a>01642         <span class="comment">//Resource dictionary</span>
<a name="l01643"></a>01643         $this-&gt;offsets[2]=strlen($this-&gt;buffer);
<a name="l01644"></a>01644         $this-&gt;_out(<span class="stringliteral">'2 0 obj'</span>);
<a name="l01645"></a>01645         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>);
<a name="l01646"></a>01646         $this-&gt;_putresourcedict();
<a name="l01647"></a>01647         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01648"></a>01648         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01649"></a>01649 }
<a name="l01650"></a>01650 
<a name="l01651"></a><a class="code" href="class_f_p_d_f.html#deada505b347aa76ae6f1522b4219fe0">01651</a> function _putinfo()
<a name="l01652"></a>01652 {
<a name="l01653"></a>01653         $this-&gt;_out(<span class="stringliteral">'/Producer '</span>.$this-&gt;_textstring(<span class="stringliteral">'FPDF '</span>.<a class="code" href="fpdf_8php.html#84b38adcfb3c697594472e91adf42b2e">FPDF_VERSION</a>));
<a name="l01654"></a>01654         <span class="keywordflow">if</span>(!empty($this-&gt;title))
<a name="l01655"></a>01655                 $this-&gt;_out(<span class="stringliteral">'/Title '</span>.$this-&gt;_textstring($this-&gt;title));
<a name="l01656"></a>01656         <span class="keywordflow">if</span>(!empty($this-&gt;subject))
<a name="l01657"></a>01657                 $this-&gt;_out(<span class="stringliteral">'/Subject '</span>.$this-&gt;_textstring($this-&gt;subject));
<a name="l01658"></a>01658         <span class="keywordflow">if</span>(!empty($this-&gt;author))
<a name="l01659"></a>01659                 $this-&gt;_out(<span class="stringliteral">'/Author '</span>.$this-&gt;_textstring($this-&gt;author));
<a name="l01660"></a>01660         <span class="keywordflow">if</span>(!empty($this-&gt;keywords))
<a name="l01661"></a>01661                 $this-&gt;_out(<span class="stringliteral">'/Keywords '</span>.$this-&gt;_textstring($this-&gt;keywords));
<a name="l01662"></a>01662         <span class="keywordflow">if</span>(!empty($this-&gt;creator))
<a name="l01663"></a>01663                 $this-&gt;_out(<span class="stringliteral">'/Creator '</span>.$this-&gt;_textstring($this-&gt;creator));
<a name="l01664"></a>01664         $this-&gt;_out(<span class="stringliteral">'/CreationDate '</span>.$this-&gt;_textstring(<span class="stringliteral">'D:'</span>.@date(<span class="stringliteral">'YmdHis'</span>)));
<a name="l01665"></a>01665 }
<a name="l01666"></a>01666 
<a name="l01667"></a><a class="code" href="class_f_p_d_f.html#f31a901fbed24337636bd85634042060">01667</a> function _putcatalog()
<a name="l01668"></a>01668 {
<a name="l01669"></a>01669         $this-&gt;_out(<span class="stringliteral">'/Type /Catalog'</span>);
<a name="l01670"></a>01670         $this-&gt;_out(<span class="stringliteral">'/Pages 1 0 R'</span>);
<a name="l01671"></a>01671         <span class="keywordflow">if</span>($this-&gt;ZoomMode==<span class="stringliteral">'fullpage'</span>)
<a name="l01672"></a>01672                 $this-&gt;_out(<span class="stringliteral">'/OpenAction [3 0 R /Fit]'</span>);
<a name="l01673"></a>01673         elseif($this-&gt;ZoomMode==<span class="stringliteral">'fullwidth'</span>)
<a name="l01674"></a>01674                 $this-&gt;_out(<span class="stringliteral">'/OpenAction [3 0 R /FitH null]'</span>);
<a name="l01675"></a>01675         elseif($this-&gt;ZoomMode==<span class="stringliteral">'real'</span>)
<a name="l01676"></a>01676                 $this-&gt;_out(<span class="stringliteral">'/OpenAction [3 0 R /XYZ null null 1]'</span>);
<a name="l01677"></a>01677         elseif(!is_string($this-&gt;ZoomMode))
<a name="l01678"></a>01678                 $this-&gt;_out(<span class="stringliteral">'/OpenAction [3 0 R /XYZ null null '</span>.($this-&gt;ZoomMode/100).<span class="charliteral">']'</span>);
<a name="l01679"></a>01679         <span class="keywordflow">if</span>($this-&gt;LayoutMode==<span class="stringliteral">'single'</span>)
<a name="l01680"></a>01680                 $this-&gt;_out(<span class="stringliteral">'/PageLayout /SinglePage'</span>);
<a name="l01681"></a>01681         elseif($this-&gt;LayoutMode==<span class="stringliteral">'continuous'</span>)
<a name="l01682"></a>01682                 $this-&gt;_out(<span class="stringliteral">'/PageLayout /OneColumn'</span>);
<a name="l01683"></a>01683         elseif($this-&gt;LayoutMode==<span class="stringliteral">'two'</span>)
<a name="l01684"></a>01684                 $this-&gt;_out(<span class="stringliteral">'/PageLayout /TwoColumnLeft'</span>);
<a name="l01685"></a>01685 }
<a name="l01686"></a>01686 
<a name="l01687"></a><a class="code" href="class_f_p_d_f.html#132522bbceb722a3181fc216f93bd9a9">01687</a> function _putheader()
<a name="l01688"></a>01688 {
<a name="l01689"></a>01689         $this-&gt;_out(<span class="stringliteral">'%PDF-'</span>.$this-&gt;PDFVersion);
<a name="l01690"></a>01690 }
<a name="l01691"></a>01691 
<a name="l01692"></a><a class="code" href="class_f_p_d_f.html#977c65c92c43a052d2ec4b1e80a2a7dd">01692</a> function _puttrailer()
<a name="l01693"></a>01693 {
<a name="l01694"></a>01694         $this-&gt;_out(<span class="stringliteral">'/Size '</span>.($this-&gt;n+1));
<a name="l01695"></a>01695         $this-&gt;_out(<span class="stringliteral">'/Root '</span>.$this-&gt;n.<span class="stringliteral">' 0 R'</span>);
<a name="l01696"></a>01696         $this-&gt;_out(<span class="stringliteral">'/Info '</span>.($this-&gt;n-1).<span class="stringliteral">' 0 R'</span>);
<a name="l01697"></a>01697 }
<a name="l01698"></a>01698 
<a name="l01699"></a><a class="code" href="class_f_p_d_f.html#5872b1a94bcd6c00a0bdd2ece02409ac">01699</a> function _enddoc()
<a name="l01700"></a>01700 {
<a name="l01701"></a>01701         $this-&gt;_putheader();
<a name="l01702"></a>01702         $this-&gt;_putpages();
<a name="l01703"></a>01703         $this-&gt;_putresources();
<a name="l01704"></a>01704         <span class="comment">//Info</span>
<a name="l01705"></a>01705         $this-&gt;_newobj();
<a name="l01706"></a>01706         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>);
<a name="l01707"></a>01707         $this-&gt;_putinfo();
<a name="l01708"></a>01708         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01709"></a>01709         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01710"></a>01710         <span class="comment">//Catalog</span>
<a name="l01711"></a>01711         $this-&gt;_newobj();
<a name="l01712"></a>01712         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>);
<a name="l01713"></a>01713         $this-&gt;_putcatalog();
<a name="l01714"></a>01714         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01715"></a>01715         $this-&gt;_out(<span class="stringliteral">'endobj'</span>);
<a name="l01716"></a>01716         <span class="comment">//Cross-ref</span>
<a name="l01717"></a>01717         $o=strlen($this-&gt;buffer);
<a name="l01718"></a>01718         $this-&gt;_out(<span class="stringliteral">'xref'</span>);
<a name="l01719"></a>01719         $this-&gt;_out(<span class="stringliteral">'0 '</span>.($this-&gt;n+1));
<a name="l01720"></a>01720         $this-&gt;_out(<span class="stringliteral">'0000000000 65535 f '</span>);
<a name="l01721"></a>01721         <span class="keywordflow">for</span>($i=1;$i&lt;=$this-&gt;n;$i++)
<a name="l01722"></a>01722                 $this-&gt;_out(sprintf(<span class="stringliteral">'%010d 00000 n '</span>,$this-&gt;offsets[$i]));
<a name="l01723"></a>01723         <span class="comment">//Trailer</span>
<a name="l01724"></a>01724         $this-&gt;_out(<span class="stringliteral">'trailer'</span>);
<a name="l01725"></a>01725         $this-&gt;_out(<span class="stringliteral">'&lt;&lt;'</span>);
<a name="l01726"></a>01726         $this-&gt;_puttrailer();
<a name="l01727"></a>01727         $this-&gt;_out(<span class="stringliteral">'&gt;&gt;'</span>);
<a name="l01728"></a>01728         $this-&gt;_out(<span class="stringliteral">'startxref'</span>);
<a name="l01729"></a>01729         $this-&gt;_out($o);
<a name="l01730"></a>01730         $this-&gt;_out(<span class="stringliteral">'%%EOF'</span>);
<a name="l01731"></a>01731         $this-&gt;state=3;
<a name="l01732"></a>01732 }
<a name="l01733"></a>01733 <span class="comment">//End of class</span>
<a name="l01734"></a>01734 }
<a name="l01735"></a>01735 
<a name="l01736"></a>01736 <span class="comment">//Handle special IE contype request</span>
<a name="l01737"></a>01737 <span class="keywordflow">if</span>(isset($_SERVER[<span class="stringliteral">'HTTP_USER_AGENT'</span>]) &amp;&amp; $_SERVER[<span class="stringliteral">'HTTP_USER_AGENT'</span>]==<span class="stringliteral">'contype'</span>)
<a name="l01738"></a>01738 {
<a name="l01739"></a>01739         header(<span class="stringliteral">'Content-Type: application/pdf'</span>);
<a name="l01740"></a>01740         exit;
<a name="l01741"></a>01741 }
<a name="l01742"></a>01742 
<a name="l01743"></a>01743 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Jan 16 16:56:28 2009 for mailformplusplus by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
